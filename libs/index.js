(()=>{"use strict";var e={33:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(7861),n=r(7729);class i extends o.Model{toJSON(){const e=super.toJSON();return e&&"object"==typeof e&&(delete e.password,delete e.forgotPassword,delete e.activationCode),e}}i.tableName=n.constants.TableName.Partners,i.idColumn="id",t.default=i},43:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(3523),t)},107:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},138:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(7861);class n extends o.Model{}n.tableName="Permissions",n.idColumn="id",n.jsonSchema={type:"object",properties:{id:{type:"integer"},moduleId:{type:"integer"},moduleName:{type:"string"},slug:{type:"string"},name:{type:"string"},path:{type:"string"},method:{type:"string"},deps:{type:"array",items:{type:"string"}},tMenus:{type:"array",items:{type:"string"}}}},t.default=n},171:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(7861),n=r(7729);class i extends o.Model{}i.tableName=n.constants.TableName.WorkOrderStatus,i.idColumn="id",i.jsonSchema={type:"object",properties:{id:{type:"integer"},slug:{type:"string"},name:{type:"string"},createdAt:{type:"string"},createdBy:{type:"integer"}}},t.default=i},193:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateChargeDto=t.CreateChargeDto=void 0;const i=r(6325),s=r(2520);class a{constructor(){this.currency="MYR"}}t.CreateChargeDto=a,o([(0,s.ApiProperty)({description:"Work Order ID associated with the charge",example:101}),(0,i.IsNotEmpty)(),(0,i.IsNumber)(),n("design:type",Number)],a.prototype,"workOrderId",void 0),o([(0,s.ApiProperty)({description:"Name or description of the charge",example:"Service Fee"}),(0,i.IsNotEmpty)(),(0,i.IsString)(),n("design:type",String)],a.prototype,"name",void 0),o([(0,s.ApiProperty)({description:"Amount of the charge",example:150}),(0,i.IsNotEmpty)(),(0,i.IsNumber)(),(0,i.Min)(0),n("design:type",Number)],a.prototype,"amount",void 0),o([(0,s.ApiProperty)({description:"Currency code",example:"MYR",default:"MYR"}),(0,i.IsOptional)(),(0,i.IsString)(),n("design:type",String)],a.prototype,"currency",void 0);class c{}t.UpdateChargeDto=c,o([(0,s.ApiPropertyOptional)({description:"Name or description of the charge",example:"Service Fee (Updated)"}),(0,i.IsOptional)(),(0,i.IsString)(),n("design:type",String)],c.prototype,"name",void 0),o([(0,s.ApiPropertyOptional)({description:"Amount of the charge",example:200}),(0,i.IsOptional)(),(0,i.IsNumber)(),(0,i.Min)(0),n("design:type",Number)],c.prototype,"amount",void 0),o([(0,s.ApiPropertyOptional)({description:"Currency code",example:"USD"}),(0,i.IsOptional)(),(0,i.IsString)(),n("design:type",String)],c.prototype,"currency",void 0)},225:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.UserStatusEnum=void 0,function(e){e.Active="Active",e.Inactive="Inactive"}(r||(t.UserStatusEnum=r={}))},266:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(5057),t),n(r(8352),t)},274:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},284:e=>{e.exports=require("class-transformer")},287:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.LibraryService=void 0;const n=r(1813);let i=class{constructor(){this.sampleData=[{id:1,name:"Product A",category:"Electronics",price:299.99},{id:2,name:"Product B",category:"Home Appliance",price:499.99},{id:3,name:"Product C",category:"Electronics",price:199.99},{id:4,name:"Service Plan Basic",category:"Service",price:49.99},{id:5,name:"Service Plan Premium",category:"Service",price:99.99}]}getSampleData(){return this.sampleData}getSampleDataById(e){return this.sampleData.find(t=>t.id===e)}getLibraryInfo(){return{name:"cakrawala-hub-library-api",version:"1.0.0"}}};t.LibraryService=i,t.LibraryService=i=o([(0,n.Injectable)()],i)},345:function(e,t,r){var o,n,i=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},s=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},a=this&&this.__param||function(e,t){return function(r,o){t(r,o,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.NatsService=void 0;const c=r(1813),l=r(5780),d=r(573);let u=o=class{constructor(e){this.client=e,this.logger=new c.Logger(o.name)}async emit(e,t){try{await(0,d.firstValueFrom)(this.client.emit(e,t)),this.logger.debug(`[NATS][EMIT] subject ${e} data=${t?.title}`)}catch(t){this.logger.error(`NATS emit failed to ${e}: ${t?.message||t}`);const r=new Error(`NATS emit failed to ${e}: ${t?.message||t}`);throw r.cause=t,r}}async send(e,t){const r=await(0,d.firstValueFrom)(this.client.send(e,t));if(this.logger.debug(`[NATS][SEND] subject=${e} data=${t?.title}`),void 0===r)throw new Error(`No response received for pattern: ${e}`);return r}};t.NatsService=u,t.NatsService=u=o=i([(0,c.Injectable)(),a(0,(0,c.Inject)("NATS_SERVICE")),s("design:paramtypes",["function"==typeof(n=void 0!==l.ClientProxy&&l.ClientProxy)?n:Object])],u)},410:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(7861);class n extends o.Model{}n.tableName="Menus",n.idColumn="id",n.jsonSchema={type:"object",properties:{id:{type:"integer"},moduleId:{type:"integer"},group:{type:"string"},group_order:{type:"integer"},name:{type:"string"},slug:{type:"string"},action:{type:"string"},type:{type:"string"},order:{type:"integer"},parent_id:{type:"integer"}}},t.default=n},467:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateUserDto=t.CreateUserDto=void 0;const i=r(6325),s=r(5007);class a{}t.CreateUserDto=a,o([(0,i.IsInt)({message:"Role ID must be an integer"}),(0,i.IsOptional)(),n("design:type",Number)],a.prototype,"roleId",void 0),o([(0,i.IsInt)({message:"Transcxp ID must be an integer"}),(0,i.IsOptional)(),n("design:type",Number)],a.prototype,"transcxpId",void 0),o([(0,i.IsInt)({message:"Territory ID must be an integer"}),(0,i.IsOptional)(),n("design:type",Number)],a.prototype,"territoryId",void 0),o([(0,i.IsInt)({message:"NSC Branch ID must be an integer"}),(0,i.IsOptional)(),n("design:type",Number)],a.prototype,"nscBranchId",void 0),o([(0,i.IsString)({message:"Salutation must be a string"}),(0,i.IsOptional)(),n("design:type",String)],a.prototype,"salutation",void 0),o([(0,i.IsEmail)({},{message:"Email must be a valid email address"}),(0,i.IsOptional)(),n("design:type",String)],a.prototype,"email",void 0),o([(0,i.IsString)({message:"Account name must be a string"}),(0,i.MinLength)(3,{message:"Account name must be at least 3 characters long"}),n("design:type",String)],a.prototype,"accountName",void 0),o([(0,i.IsString)({message:"First name must be a string"}),(0,i.MinLength)(2,{message:"First name must be at least 2 characters long"}),n("design:type",String)],a.prototype,"firstName",void 0),o([(0,i.IsString)({message:"Middle name must be a string"}),(0,i.IsOptional)(),n("design:type",String)],a.prototype,"middleName",void 0),o([(0,i.IsString)({message:"Last name must be a string"}),(0,i.MinLength)(2,{message:"Last name must be at least 2 characters long"}),n("design:type",String)],a.prototype,"lastName",void 0),o([(0,i.IsPhoneNumber)(null,{message:"Mobile phone must be a valid phone number"}),(0,i.IsOptional)(),n("design:type",String)],a.prototype,"mobilePhone",void 0),o([(0,i.IsPhoneNumber)(null,{message:"Home phone must be a valid phone number"}),(0,i.IsOptional)(),n("design:type",String)],a.prototype,"homePhone",void 0),o([(0,i.IsPhoneNumber)(null,{message:"Business phone must be a valid phone number"}),(0,i.IsOptional)(),n("design:type",String)],a.prototype,"businessPhone",void 0),o([(0,i.IsString)({message:"Suffix must be a string"}),(0,i.IsOptional)(),n("design:type",String)],a.prototype,"suffix",void 0),o([(0,i.IsString)({message:"Tax payer ID must be a string"}),(0,i.IsOptional)(),n("design:type",String)],a.prototype,"taxPayerId",void 0),o([(0,i.IsString)({message:"Gender must be a string"}),(0,i.IsOptional)(),n("design:type",String)],a.prototype,"gender",void 0),o([(0,i.IsString)({message:"Status must be a string"}),(0,i.IsOptional)(),n("design:type",String)],a.prototype,"status",void 0),o([(0,i.IsString)({message:"Remark must be a string"}),(0,i.IsOptional)(),n("design:type",String)],a.prototype,"remark",void 0);class c extends((0,s.PartialType)(a)){}t.UpdateUserDto=c},573:e=>{e.exports=require("rxjs")},581:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.transformFilterObject=c,t.filtersTransformer=function e(t){if(t.type!=n.TransformationType.PLAIN_TO_CLASS)throw new Error(`Unsupported ${n.TransformationType[t.type]} transformation`);const r=t.value;if(Array.isArray(r))return new i.PaginationFilterOrDto(...r.map(r=>e.call(this,{...t,value:r})));if((0,o.isPlainObject)(r)){for(const e in r)r[e]=c(r[e]);return(0,n.plainToInstance)(i.PaginationFilterAndDto,r)}return r},t.sortsTransformer=function({value:e}){(0,o.isPlainObject)(e)?e=Object.entries(e).map(([e,t])=>({[e]:(0,a.paginationSanitizeSortValue)(t)})):Array.isArray(e)&&e.forEach(e=>Object.keys(e).forEach(t=>e[t]=(0,a.paginationSanitizeSortValue)(e[t])));return e};const o=r(7546),n=r(284),i=r(1495),s=r(1495),a=r(3020);function c(e){switch(typeof e){case"number":case"string":e={op:"equal",value:e}}switch(e.op){case"equal":case"notEqual":return(0,n.plainToInstance)(s.FilterObjectEqualityDto,e);case"lessThan":case"greaterThan":return(0,n.plainToInstance)(s.FilterObjectLessGreaterDto,e);case"between":return(0,n.plainToInstance)(s.FilterObjectBetweenDto,e);case"like":return(0,n.plainToInstance)(s.FilterObjectLikeDto,e);case"isNull":case"isNotNull":return(0,n.plainToInstance)(s.FilterObjectNullDto,e);case"in":case"notIn":return(0,n.plainToInstance)(s.FilterObjectInDto,e);default:return(0,n.plainToInstance)(s.FilterObjectDto,e)}}},606:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(5033),t),n(r(2152),t)},803:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(6578),t),n(r(9227),t)},823:function(e,t,r){var o,n=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},s=this&&this.__param||function(e,t){return function(r,o){t(r,o,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.PartnerService=void 0;const a=r(1813),c=r(1944),l=r(7976),d=r(1706),u=r(6088),p=r(9044),f=r(4014),y=r(4413),m=r(1712);let g=class{constructor(e){this.logger=e,this.PARTNER_SEARCH_COLUMNS=["idText","name","email","mobilePhone","updatedByName"],e||(this.logger=new a.Logger("PartnerService"))}async checkEmailExists(e,t){let r=c.UserModel.query().where("email",e);t&&(r=r.whereNot("id",t));return!!await r.first()}async checkMobilePhoneExists(e,t){let r=c.UserModel.query().where("mobilePhone",e);t&&(r=r.whereNot("id",t));return!!await r.first()}async checkBusinessPhoneExists(e,t){let r=c.UserModel.query().where("businessPhone",e);t&&(r=r.whereNot("id",t));return!!await r.first()}async validateUniqueFieldsForCreate(e){const t={};if(e.email){await this.checkEmailExists(e.email)&&(t.email="email is exist")}if(e.mobilePhone){await this.checkMobilePhoneExists(e.mobilePhone)&&(t.mobilePhone="mobile phone is exist")}if(e.businessPhone){await this.checkBusinessPhoneExists(e.businessPhone)&&(t.businessPhone="business phone is exist")}if(Object.keys(t).length>0){const e=[];throw Object.entries(t).forEach(([t,r])=>{e.push({property:t,constraints:{unique:r}})}),new p.ValidationException(e)}}async validateUniqueFieldsForUpdate(e,t){const r=await c.PartnerModel.query().findById(e);if(!r)throw new a.NotFoundException(`Partner with ID ${e} not found`);const o={};if(t.email){await this.checkEmailExists(t.email,r.userId)&&(o.email="email is exist")}if(t.mobilePhone){await this.checkMobilePhoneExists(t.mobilePhone,r.userId)&&(o.mobilePhone="mobile phone is exist")}if(t.businessPhone){await this.checkBusinessPhoneExists(t.businessPhone,r.userId)&&(o.businessPhone="business phone is exist")}if(Object.keys(o).length>0){const e=[];throw Object.entries(o).forEach(([t,r])=>{e.push({property:t,constraints:{unique:r}})}),new p.ValidationException(e)}}buildPartnersSubquery(){return c.PartnerModel.query().join("Users","Partners.userId","=","Users.id").leftJoin("Users as CreatedByUser","Partners.createdBy","=","CreatedByUser.id").leftJoin("Users as UpdatedByUser","Partners.updatedBy","=","UpdatedByUser.id").where("Partners.deletedAt","is",null).select("Partners.id","Users.email","Users.firstName","Users.middleName","Users.lastName","Users.mobilePhone","Partners.lastLogin","Partners.createdAt","Partners.updatedAt","Users.status",c.PartnerModel.raw('CAST("Partners"."id" AS TEXT) as "idText"'),c.PartnerModel.raw('CONCAT("Users"."firstName", \' \', COALESCE("Users"."middleName", \'\'), \' \', "Users"."lastName") as "name"'),c.PartnerModel.raw('CASE \n          WHEN COALESCE("CreatedByUser"."firstName", \'\') = \'\' \n            AND COALESCE("CreatedByUser"."middleName", \'\') = \'\' \n            AND COALESCE("CreatedByUser"."lastName", \'\') = \'\' \n          THEN \'\'\n          ELSE TRIM(CONCAT(COALESCE("CreatedByUser"."firstName", \'\'), \' \', COALESCE("CreatedByUser"."middleName", \'\'), \' \', COALESCE("CreatedByUser"."lastName", \'\')))\n        END as "createdByName"'),c.PartnerModel.raw('CASE \n          WHEN COALESCE("UpdatedByUser"."firstName", \'\') = \'\' \n            AND COALESCE("UpdatedByUser"."middleName", \'\') = \'\' \n            AND COALESCE("UpdatedByUser"."lastName", \'\') = \'\' \n          THEN \'\'\n          ELSE TRIM(CONCAT(COALESCE("UpdatedByUser"."firstName", \'\'), \' \', COALESCE("UpdatedByUser"."middleName", \'\'), \' \', COALESCE("UpdatedByUser"."lastName", \'\')))\n        END as "updatedByName"'))}async listAllPartners(e,t){let r,o;this.logger.log("initialization query - building subquery");const n=c.PartnerModel.query().from(this.buildPartnersSubquery().as("subquery"));this.logger.log("count data from subquery");const i=c.PartnerModel.query().from(this.buildPartnersSubquery().as("subquery")).count("* as count");if(e.filters){this.logger.log("apply filters data");const t=(0,d.processSearchFilterWithColumns)(e.filters,this.PARTNER_SEARCH_COLUMNS);(0,y.applyFilters)(t,n),(0,y.applyFilters)(t,i)}e.sorts&&(this.logger.log("apply sort data"),(0,y.applySorts)(e.sorts,n)),e instanceof f.PaginationDto&&(r=e.page,o=e.count,this.logger.log("apply pagination data"),(0,y.applyPagination)({page:r,count:o},n));const[s,a]=await Promise.all([n,i]);return{page:r,count:o,total:parseInt(a[0]?.count),items:s}}async findPartnerById(e,t){const r=await c.PartnerModel.query().findOne({id:e});if(!r)throw new a.NotFoundException(`Partner with ID ${e} not found`);const o=await c.UserModel.query().findById(r.userId);if(!o)throw new a.NotFoundException(`User with ID ${r.userId} not found`);const n={roleId:1,role:{id:1,name:"partner"},integrationId:1,territoryId:1,salutation:o.salutation,nscBranchId:1,name:`${o.firstName} ${o.middleName||""} ${o.lastName}`.trim(),email:o.email,mobilePhone:o.mobilePhone,businessPhone:o.businessPhone,suffix:o.suffix,taxPayerId:o.taxPayerId,gender:o.gender,status:o.status,startDate:"2026-05-05T09:45:14.329Z",endDate:"2026-05-05T09:45:14.329Z",remark:o.remark},i=await c.UserAddressModel.query().where("userId",r.userId).where("addressType",u.AddressTypeEnum.Billing).orderBy("id","desc").first(),s=await c.UserAddressModel.query().where("userId",r.userId).where("addressType",u.AddressTypeEnum.Mailing).orderBy("id","desc").first();return{accountInformation:n,billingAddressInformation:i?{country:i.country,province:i.stateOrProvince,city:i.city,subDistrict:i.subDistrict,village:i.village,postalCode:i.zipOrPostalCode,street:i.street}:{},mailingAddressInformation:s?{country:s.country,province:s.stateOrProvince,city:s.city,subDistrict:s.subDistrict,village:s.village,postalCode:s.zipOrPostalCode,street:s.street}:{}}}async createPartner(e,t){const{accountInformation:r,billingAddressInformation:o,mailingAddressInformation:n}=e;await this.validateUniqueFieldsForCreate(r);const{firstName:i,middleName:s,lastName:a}=(0,l.splitName)(r.name),d={updatedBy:t.userId,createdBy:t.userId,updatedAt:new Date},p=await(0,m.genSalt)(10),f=await(0,m.hash)(e.accountInformation.password,p),y=await c.PartnerModel.startTransaction();try{const e=await c.UserModel.query(y).insert({firstName:i,middleName:s,lastName:a,businessPhone:r.businessPhone,mobilePhone:r.mobilePhone,gender:r.gender,status:!0,email:r.email,roleId:r.roleId,territoryId:r.territoryId,nscBranchId:r.nscBranchId,taxPayerId:r?.taxPayerId,salutation:r.salutation,suffix:r.suffix,remark:r.remark,...d}),t=await c.PartnerModel.query(y).insert({userId:e.id,password:f,...d});return await c.UserAddressModel.query(y).insert({userId:e.id,addressType:u.AddressTypeEnum.Billing,country:o?.country,stateOrProvince:o?.province,city:o?.city,subDistrict:o?.subDistrict,village:o?.village,zipOrPostalCode:o?.postalCode,street:o?.street}),await c.UserAddressModel.query(y).insert({userId:e.id,addressType:u.AddressTypeEnum.Mailing,country:n?.country,stateOrProvince:n?.province,city:n?.city,subDistrict:n?.subDistrict,village:n?.village,zipOrPostalCode:n?.postalCode,street:n?.street}),await y.commit(),t}catch(e){throw await y.rollback(),e}}async updatePartner(e,t,r){try{const o=await c.PartnerModel.query().findById(e);if(!o)throw new a.NotFoundException(`Partner with ID ${e} not found`);t.accountInformation&&await this.validateUniqueFieldsForUpdate(e,t.accountInformation);const n={updatedBy:r.userId,updatedAt:new Date},i=await c.PartnerModel.startTransaction();try{if(t.accountInformation){const e={...n};if(t.accountInformation.name){const{firstName:r,middleName:o,lastName:n}=(0,l.splitName)(t.accountInformation.name);r&&(e.firstName=r),o&&(e.middleName=o),n&&(e.lastName=n)}t.accountInformation.businessPhone&&(e.businessPhone=t.accountInformation.businessPhone),t.accountInformation.mobilePhone&&(e.mobilePhone=t.accountInformation.mobilePhone),t.accountInformation.gender&&(e.gender=t.accountInformation.gender),t.accountInformation.email&&(e.email=t.accountInformation.email),t.accountInformation.salutation&&(e.salutation=t.accountInformation.salutation),t.accountInformation.suffix&&(e.suffix=t.accountInformation.suffix),t.accountInformation.remark&&(e.remark=t.accountInformation.remark),void 0!==t.accountInformation.status&&(e.status=t.accountInformation.status),t.accountInformation.roleId&&(e.roleId=t.accountInformation.roleId),t.accountInformation.territoryId&&(e.territoryId=t.accountInformation.territoryId),t.accountInformation.nscBranchId&&(e.nscBranchId=t.accountInformation.nscBranchId),t.accountInformation.taxPayerId&&(e.taxPayerId=t.accountInformation.taxPayerId),await c.UserModel.query(i).findById(o.userId).patch(e)}if(t.billingAddressInformation){const e={...n};t.billingAddressInformation.country&&(e.country=t.billingAddressInformation.country),t.billingAddressInformation.province&&(e.stateOrProvince=t.billingAddressInformation.province),t.billingAddressInformation.city&&(e.city=t.billingAddressInformation.city),t.billingAddressInformation.subDistrict&&(e.subDistrict=t.billingAddressInformation.subDistrict),t.billingAddressInformation.village&&(e.village=t.billingAddressInformation.village),t.billingAddressInformation.postalCode&&(e.zipOrPostalCode=t.billingAddressInformation.postalCode),t.billingAddressInformation.street&&(e.street=t.billingAddressInformation.street),Object.keys(e).length>2&&await c.UserAddressModel.query(i).where("userId",o.userId).where("addressType",u.AddressTypeEnum.Billing).patch(e)}if(t.mailingAddressInformation){const e={...n};t.mailingAddressInformation.country&&(e.country=t.mailingAddressInformation.country),t.mailingAddressInformation.province&&(e.stateOrProvince=t.mailingAddressInformation.province),t.mailingAddressInformation.city&&(e.city=t.mailingAddressInformation.city),t.mailingAddressInformation.subDistrict&&(e.subDistrict=t.mailingAddressInformation.subDistrict),t.mailingAddressInformation.village&&(e.village=t.mailingAddressInformation.village),t.mailingAddressInformation.postalCode&&(e.zipOrPostalCode=t.mailingAddressInformation.postalCode),t.mailingAddressInformation.street&&(e.street=t.mailingAddressInformation.street),Object.keys(e).length>2&&await c.UserAddressModel.query(i).where("userId",o.userId).where("addressType",u.AddressTypeEnum.Mailing).patch(e)}await i.commit();return await c.PartnerModel.query().findById(e)}catch(e){throw await i.rollback(),e}}catch(e){throw e}}async deletePartner(e,t){const r=await c.PartnerModel.query().findOne({id:e,deletedAt:null});if(!r)throw new a.NotFoundException(`Partner with ID ${e} not found or has been deleted`);return r.deletedBy=t.userId,r.deletedAt=new Date,await r.$query().patch(),{message:`Partner with ID ${e} deleted successfully`,id:e}}};t.PartnerService=g,t.PartnerService=g=n([(0,a.Injectable)(),s(0,(0,a.Inject)(a.Logger)),s(0,(0,a.Optional)()),i("design:paramtypes",["function"==typeof(o=void 0!==a.LoggerService&&a.LoggerService)?o:Object])],g)},872:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.WorkOrderModule=void 0;const n=r(1813),i=r(4873);let s=class{};t.WorkOrderModule=s,t.WorkOrderModule=s=o([(0,n.Module)({providers:[i.WorkOrderService],exports:[i.WorkOrderService]})],s)},911:function(e,t,r){var o,n,i,s=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},c=this&&this.__param||function(e,t){return function(r,o){t(r,o,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.AccessTokenGuard=void 0;const l=r(1813),d=r(7819),u=r(4602),p=r(9124),f=r(7175),y=r(4671),m=r(1514);let g=class extends((0,u.AuthGuard)("token")){constructor(e,t,r){super({property:"token"}),this.reflector=e,this.logger=r,r||(this.logger=new l.Logger("AuthLibrary")),this.allowedAppType=t.get("TOKEN_APP_TYPE_ALLOWED"),this.allowedAppType||this.logger.warn("No TOKEN_APP_TYPE_ALLOWED is set in the application. Any token will valid even it created from another app!")}getPermissions(e){return this.reflector.getAllAndOverride(p.PERMISSION_METADATA,[e.getHandler(),e.getClass()])}getPermissionsAsAccessObject(e){const t=this.getPermissions(e);return t?{[t.module]:[t.action]}:{}}canActivate(e){if("http"!=e.getType())return this.logger.verbose(`[Guard] not handling ${e.getType()}`),super.canActivate(e);return!1===this.getPermissions(e)||super.canActivate(e)}handleRequest(e,t,r,o){if(this.logger.verbose("[Guard] Token checking.."),r&&["JsonWebTokenError","TokenExpiredError"].includes(r.constructor?.name)){if("TokenExpiredError"==r.constructor.name)throw this.logger.verbose("[Guard] Token expired"),new f.AuthExpiredAccessTokenException;throw this.logger.verbose("[Guard] Token invalid",r),r}if(e)throw this.logger.verbose("[Guard] Token error",e),e;if(this.allowedAppType&&this.allowedAppType!==t.app)throw this.logger.warn("[Guard] Token app type miss match",t),new l.UnauthorizedException("Invalid app token type");const n=this.getPermissionsAsAccessObject(o);if(!t)throw this.logger.verbose("[Guard] Token not found"),new l.UnauthorizedException;let i,s;if(this.logger.verbose("[Guard] Token valid"),(0,y.checkAccess)(n,t.access)?s=n:i=(0,y.getMissingAccess)(n,t.access),!s)throw this.logger.verbose("[Guard] Blocked, missing permissions",i),new f.AuthForbiddenException(i);return this.logger.verbose("[Guard] Passed, permissions OK"),t}};t.AccessTokenGuard=g,t.AccessTokenGuard=g=s([(0,l.Injectable)(),c(2,(0,l.Optional)()),c(2,(0,l.Inject)(l.Logger)),a("design:paramtypes",["function"==typeof(o=void 0!==d.Reflector&&d.Reflector)?o:Object,"function"==typeof(n=void 0!==m.ConfigService&&m.ConfigService)?n:Object,"function"==typeof(i=void 0!==l.LoggerService&&l.LoggerService)?i:Object])],g)},919:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ManualInventoryRequestTypeEnum=void 0,function(e){e.None="None",e.Increase="Increase",e.Decrease="Decrease"}(r||(t.ManualInventoryRequestTypeEnum=r={}))},932:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(5432),t)},944:function(e,t,r){var o,n,i,s,a,c,l=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},d=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateCustomerDto=t.CreateCustomerDto=t.UpdateAccountInformationDto=t.AccountInformationDto=t.AddressDto=void 0;const u=r(6325),p=r(284),f=r(6088),y=r(5007),m=r(2485);class g{}t.AddressDto=g,l([(0,u.IsString)({message:"Country must be a string"}),(0,u.IsOptional)(),(0,p.Transform)(({value:e})=>(0,m.safeTrim)(e)),d("design:type",String)],g.prototype,"country",void 0),l([(0,u.IsString)({message:"Province must be a string"}),(0,u.IsOptional)(),(0,p.Transform)(({value:e})=>(0,m.safeTrim)(e)),d("design:type",String)],g.prototype,"province",void 0),l([(0,u.IsString)({message:"City must be a string"}),(0,u.IsOptional)(),(0,p.Transform)(({value:e})=>(0,m.safeTrim)(e)),d("design:type",String)],g.prototype,"city",void 0),l([(0,u.IsString)({message:"Sub-district must be a string"}),(0,u.IsOptional)(),(0,p.Transform)(({value:e})=>(0,m.safeTrim)(e)),d("design:type",String)],g.prototype,"subDistrict",void 0),l([(0,u.IsString)({message:"Village must be a string"}),(0,u.IsOptional)(),(0,p.Transform)(({value:e})=>(0,m.safeTrim)(e)),d("design:type",String)],g.prototype,"village",void 0),l([(0,u.IsInt)({message:"Postal code must be a string"}),(0,u.IsOptional)(),d("design:type",Number)],g.prototype,"postalCode",void 0),l([(0,u.IsString)({message:"Street must be a string"}),(0,u.IsOptional)(),(0,p.Transform)(({value:e})=>(0,m.safeTrim)(e)),d("design:type",String)],g.prototype,"street",void 0);class h{}t.AccountInformationDto=h,l([(0,u.IsString)({message:"name must be a string"}),(0,u.IsNotEmpty)({message:"name should not be empty"}),(0,p.Transform)(({value:e})=>(0,m.safeTrim)(e)),d("design:type",String)],h.prototype,"name",void 0),l([(0,u.IsEnum)(f.SalutationEnum,{message:"salutation must be a valid enum value"}),d("design:type","function"==typeof(o=void 0!==f.SalutationEnum&&f.SalutationEnum)?o:Object)],h.prototype,"salutation",void 0),l([(0,u.IsEmail)({},{message:"email must be a valid email address"}),(0,p.Transform)(({value:e})=>(0,m.safeTrim)(e)),d("design:type",String)],h.prototype,"email",void 0),l([(0,u.IsAlphanumeric)(),(0,u.Length)(8,15,{message:"businessPhone must be between 8 and 15 characters long"}),(0,u.IsOptional)(),d("design:type",String)],h.prototype,"businessPhone",void 0),l([(0,u.IsAlphanumeric)(),(0,u.Length)(8,15,{message:"mobilePhone must be between 8 and 15 characters long"}),(0,u.IsNotEmpty)({message:"mobilePhone should not be empty"}),d("design:type",String)],h.prototype,"mobilePhone",void 0),l([(0,u.IsString)({message:"suffix must be a string"}),(0,u.IsOptional)(),(0,p.Transform)(({value:e})=>(0,m.safeTrim)(e)),d("design:type",String)],h.prototype,"suffix",void 0),l([(0,u.IsEnum)(f.GenderEnum,{message:"gender must be a valid enum value"}),d("design:type","function"==typeof(n=void 0!==f.GenderEnum&&f.GenderEnum)?n:Object)],h.prototype,"gender",void 0),l([(0,u.IsBoolean)({message:"status must be a boolean"}),d("design:type",Boolean)],h.prototype,"status",void 0),l([(0,u.IsEnum)(f.MembershipTypeEnum,{message:"membershipType must be a valid enum value"}),d("design:type","function"==typeof(i=void 0!==f.MembershipTypeEnum&&f.MembershipTypeEnum)?i:Object)],h.prototype,"membershipType",void 0),l([(0,u.IsString)({message:"remark must be a string"}),(0,u.IsOptional)(),(0,p.Transform)(({value:e})=>(0,m.safeTrim)(e)),d("design:type",String)],h.prototype,"remark",void 0);class b extends((0,y.PartialType)(h)){}t.UpdateAccountInformationDto=b;class v{}t.CreateCustomerDto=v,l([(0,u.ValidateNested)(),(0,p.Type)(()=>h),(0,u.IsNotEmpty)({message:"Account information should not be empty"}),d("design:type",h)],v.prototype,"accountInformation",void 0),l([(0,u.ValidateNested)(),(0,p.Type)(()=>g),(0,u.IsOptional)(),d("design:type",g)],v.prototype,"billingAddressInformation",void 0),l([(0,u.ValidateNested)(),(0,p.Type)(()=>g),(0,u.IsOptional)(),d("design:type",g)],v.prototype,"mailingAddressInformation",void 0);class O{}t.UpdateCustomerDto=O,l([(0,u.ValidateNested)(),(0,p.Type)(()=>b),(0,u.IsOptional)(),d("design:type","function"==typeof(s="undefined"!=typeof Partial&&Partial)?s:Object)],O.prototype,"accountInformation",void 0),l([(0,u.ValidateNested)(),(0,p.Type)(()=>g),(0,u.IsOptional)(),d("design:type","function"==typeof(a="undefined"!=typeof Partial&&Partial)?a:Object)],O.prototype,"billingAddressInformation",void 0),l([(0,u.ValidateNested)(),(0,p.Type)(()=>g),(0,u.IsOptional)(),d("design:type","function"==typeof(c="undefined"!=typeof Partial&&Partial)?c:Object)],O.prototype,"mailingAddressInformation",void 0)},945:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(7861),n=r(7729);class i extends o.Model{}i.tableName=n.constants.TableName.Customers,i.idColumn="id",t.default=i},1187:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.GetAllWorkOrderUseCase=void 0;const n=r(1813),i=r(6245);let s=class{async execute(){return await this.getData(),this.data}async getData(){this.data=await i.WorkOrderModel.query().withGraphJoined("[customer(selectCustomer), status(selectStatus)]").whereNull("deletedAt").modifiers({selectCustomer(e){e.select("id","firstName","middleName","lastName")},selectStatus(e){e.select("id","name")}})}};t.GetAllWorkOrderUseCase=s,t.GetAllWorkOrderUseCase=s=o([(0,n.Injectable)()],s)},1193:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TableName=void 0,t.TableName={Customers:"Customers",Permissions:"Permissions",Modules:"Modules",Menus:"Menus",Roles:"Roles",Technicians:"Technicians",Partners:"Partners",UserAdresses:"UserAdresses",UserAddresses:"UserAddresses",Users:"Users",WorkOrders:"WorkOrders",WorkOrderStatus:"WorkOrderStatus",WorkOrderSubStatus:"WorkOrderSubStatus",WorkOrderJobReason:"WorkOrderJobReason",Claims:"Claims",Charges:"Charges",IrisCodes:"IrisCodes",Invoices:"Invoices"}},1206:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(2047),t),n(r(5947),t),n(r(3037),t),n(r(5877),t),n(r(107),t),n(r(2717),t),n(r(7578),t),n(r(2585),t),n(r(4626),t),n(r(6077),t),n(r(274),t),n(r(5306),t),n(r(8109),t),n(r(1879),t),n(r(4246),t),n(r(4724),t)},1212:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(4424),t),n(r(6329),t)},1284:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.SampleModule=void 0;const n=r(1813),i=r(2213);let s=class{};t.SampleModule=s,t.SampleModule=s=o([(0,n.Module)({providers:[i.SampleService],exports:[i.SampleService]})],s)},1321:e=>{e.exports=require("reflect-metadata")},1357:function(e,t,r){var o,n=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},s=this&&this.__param||function(e,t){return function(r,o){t(r,o,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.AccessTokenStrategy=void 0;const a=r(9200),c=r(4602),l=r(1813),d=r(6661),u=r(5096),p=r(9124),f=r(1944),y=r(7729);let m=class extends((0,c.PassportStrategy)(a.Strategy,"token")){constructor(e){super({jwtFromRequest:a.ExtractJwt.fromExtractors([a.ExtractJwt.fromAuthHeaderAsBearerToken(),e=>{const t=e.cookies||e.headers?.cookie&&u.parse(e.headers?.cookie);return t&&t.token||null},e=>e.query?.token||null]),ignoreExpiration:!1,secretOrKey:e.publicKey||e.secret,algorithms:e.signOptions?.algorithm?[e.signOptions.algorithm]:["HS256"]})}async validate(e){if(!e||"object"!=typeof e||!("userId"in e))return Promise.reject(new l.BadRequestException("Invalid token"));const t=await f.UserModel.query().findById(e.userId).first();if(!t)return Promise.reject(new l.UnauthorizedException(`User id ${e.userId} not found`));const r=await f.RoleModel.query().select("id","permissions","name","slug").findById(t.roleId).first();if(!r)return Promise.reject(new l.UnauthorizedException("Invalid role id"));const o={};return(await f.PermissionModel.query().select(`${y.constants.TableName.Permissions}.id`,`${y.constants.TableName.Permissions}.slug`,`${y.constants.TableName.Modules}.slug as moduleSlug`).join(y.constants.TableName.Modules,`${y.constants.TableName.Permissions}.moduleId`,`${y.constants.TableName.Modules}.id`).whereIn(`${y.constants.TableName.Permissions}.id`,r.permissions)).forEach(e=>{const{moduleSlug:t,slug:r}=e;t in o||(o[t]=[]),o[t].push(r)}),{userId:e.userId,app:e.app,role:{id:r.id,name:r.name,slug:r.slug},user:t,access:o,createdAt:new Date(1e3*e.iat),expiredAt:new Date(1e3*e.exp)}}};t.AccessTokenStrategy=m,t.AccessTokenStrategy=m=n([(0,l.Injectable)(),s(0,(0,l.Inject)(p.JWT_MODULE_OPTIONS)),i("design:paramtypes",["function"==typeof(o=void 0!==d.JwtModuleOptions&&d.JwtModuleOptions)?o:Object])],m)},1409:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.SalutationEnum=void 0,function(e){e.None="None",e.Mr="Mr.",e.Ms="Ms.",e.Mrs="Mrs.",e.Dr="Dr.",e.Prof="Prof."}(r||(t.SalutationEnum=r={}))},1495:function(e,t,r){var o,n,i,s=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.FilterObjectNullDto=t.FilterObjectInDto=t.FilterObjectBetweenDto=t.FilterObjectLessGreaterDto=t.FilterObjectLikeDto=t.FilterObjectEqualityDto=t.FilterObjectDto=t.PaginationFilterAndDto=t.PaginationFilterOrDto=void 0;const c=r(284),l=r(6325),d=r(7621),u=r(1916);t.PaginationFilterOrDto=class extends Array{};class p extends Map{toJSON(){return Object.fromEntries(this.entries())}}t.PaginationFilterAndDto=p;class f{}t.FilterObjectDto=f,s([(0,l.IsEnum)(d.FilterOperator),a("design:type","function"==typeof(o=void 0!==d.FilterOperatorName&&d.FilterOperatorName)?o:Object)],f.prototype,"op",void 0),s([(0,c.Type)(()=>String,{discriminator:{property:"op",subTypes:[{name:"between",value:Array},{name:"in",value:Array},{name:"notIn",value:Array}]},keepDiscriminatorProperty:!0}),a("design:type",Object)],f.prototype,"value",void 0);class y extends f{}t.FilterObjectEqualityDto=y,s([(0,l.IsIn)([d.FilterOperator.equal,d.FilterOperator.notEqual]),a("design:type",Object)],y.prototype,"op",void 0),s([(0,u.IsOneOfNative)(["string","number"]),a("design:type",Object)],y.prototype,"value",void 0);class m extends f{}t.FilterObjectLikeDto=m,s([(0,l.Equals)(d.FilterOperator.like),a("design:type","function"==typeof(n=void 0!==d.FilterOperator&&d.FilterOperator.like)?n:Object)],m.prototype,"op",void 0),s([(0,l.IsString)(),a("design:type",String)],m.prototype,"value",void 0);class g extends f{}t.FilterObjectLessGreaterDto=g,s([(0,l.IsIn)([d.FilterOperator.lessThan,d.FilterOperator.greaterThan]),a("design:type",Object)],g.prototype,"op",void 0),s([(0,u.IsOneOfNative)(["string","number"]),a("design:type",Object)],g.prototype,"value",void 0);class h extends f{}t.FilterObjectBetweenDto=h,s([(0,l.Equals)(d.FilterOperator.between),a("design:type","function"==typeof(i=void 0!==d.FilterOperator&&d.FilterOperator.between)?i:Object)],h.prototype,"op",void 0),s([(0,u.IsOneOfNative)(["string","number"],{each:!0}),(0,l.IsArray)(),(0,u.IsBetweenFilter)(),a("design:type",Array)],h.prototype,"value",void 0);class b extends f{}t.FilterObjectInDto=b,s([(0,l.IsIn)([d.FilterOperator.in,d.FilterOperator.notIn]),a("design:type",Object)],b.prototype,"op",void 0),s([(0,l.IsArray)(),(0,l.IsNotEmpty)(),(0,l.ArrayMinSize)(1),(0,l.ArrayMaxSize)(20),(0,u.IsOneOfNative)(["string","number"],{each:!0}),a("design:type",Array)],b.prototype,"value",void 0);class v extends f{}t.FilterObjectNullDto=v,s([(0,l.IsIn)([d.FilterOperator.isNull,d.FilterOperator.isNotNull]),a("design:type",Object)],v.prototype,"op",void 0),s([(0,l.Equals)(void 0,{message:"$property isNull/isNotNull cannot have value"}),a("design:type",void 0)],v.prototype,"value",void 0)},1514:e=>{e.exports=require("@nestjs/config")},1599:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(7861),n=r(7729);class i extends o.Model{}i.tableName=n.constants.TableName.Claims,i.idColumn="id",i.jsonSchema={type:"object",required:["id","claimNumber","woId","claimStatus","claimAmount"],properties:{id:{type:"integer"},claimNumber:{type:"string"},woId:{type:"integer"},claimStatus:{type:"string"},claimAmount:{type:"number"},createdAt:{type:"string"},createdBy:{type:"integer"}}},t.default=i},1606:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.AddressTypeEnum=void 0,function(e){e.Billing="billing",e.Shipping="shipping",e.Mailing="mailing"}(r||(t.AddressTypeEnum=r={}))},1706:(e,t)=>{function r(e,t){return e&&t&&0!==t.length?t.map(t=>({[t]:e})):[]}Object.defineProperty(t,"__esModule",{value:!0}),t.expandSearchFilter=r,t.processSearchFilterWithColumns=function(e,t){if(e instanceof Map){if(!e.has("search"))return e;const o={},n=new Map(e),i=n.get("search");n.delete("search");const s=r(i,t);return o._searchGroup=s,n.forEach((e,t)=>{o[t]=e}),o}if(Array.isArray(e)){const o=[];return e.forEach(e=>{if(e instanceof Map&&e.has("search")){const n=e.get("search"),i={},s=r(n,t);i._searchGroup=s;const a=new Map(e);a.delete("search"),a.forEach((e,t)=>{i[t]=e}),o.push(i)}else o.push(e)}),o.length>0?o:e}return e}},1712:e=>{e.exports=require("bcrypt")},1714:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(7861),n=r(7729);class i extends o.Model{}i.tableName=n.constants.TableName.IrisCodes,i.idColumn="id",i.jsonSchema={type:"object",required:["id"],properties:{id:{type:"integer"},conditionCode:{type:"string"},conditionDetail:{type:"string"},symptomGroup:{type:"string"},symptomGroup2:{type:"string"},symptomCode:{type:"string"},symptomDetail:{type:"string"},defectCode:{type:"string"},defectDetail:{type:"string"},repairCode:{type:"string"},repairDetail:{type:"string"},technicalRemark:{type:"string"},productCondition:{type:"string"},specialInstructionsToPartAdmin:{type:"string"},createdAt:{type:"string"},createdBy:{type:"integer"}}},t.default=i},1770:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.WorkOrderDeliveryMethodEnum=void 0,function(e){e.None="None",e.Delivery="Delivery",e.SelfCollect="Self-collect"}(r||(t.WorkOrderDeliveryMethodEnum=r={}))},1813:e=>{e.exports=require("@nestjs/common")},1879:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},1916:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IsSingleKeyObjectWithEnum=function(e=i.PaginationSortOrder,t){return(0,n.ValidateBy)({name:"isSingleKeyObjectWithEnum",constraints:[e],validator:{validate(e,t){if(!(0,o.isPlainObject)(e))return!1;const r=Object.getOwnPropertyNames(e);return!(r.length>1)&&(0,n.isEnum)(e[r[0]],t.constraints[0])},defaultMessage:(0,n.buildMessage)(e=>e+"$property must be single-keyed object with valid enum value",t)}},t)},t.IsBetweenFilter=function(e){return(0,n.ValidateBy)({name:"isBetweenFilter",validator:{validate:e=>Array.isArray(e)&&2==e.length&&("string"==typeof e[0]&&"string"==typeof e[1]||"number"==typeof e[0]&&"number"==typeof e[1]),defaultMessage:(0,n.buildMessage)(e=>e+"$property must be valid between value [string, string] or [number, number]",e)}},e)},t.IsOneOf=function(e,t){return(0,n.ValidateBy)({name:"isOneOf",validator:{validate:t=>!!e.find(e=>t instanceof e),defaultMessage:({value:t})=>`${typeof t} is not in [${e.map(e=>e.name).join(", ")}]`}},t)},t.IsOneOfNative=function(e,t){return(0,n.ValidateBy)({name:"isOneOfNative",validator:{validate:t=>e.includes(typeof t),defaultMessage:({value:t})=>`Current type ${typeof t} is not in [${e.join(", ")}]`}},t)};const o=r(7546),n=r(6325),i=r(7621)},1944:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InvoiceModel=t.ChargeModel=t.IrisModel=t.ClaimModel=t.CustomerModel=t.PermissionModel=t.ModuleModel=t.MenuModel=t.RoleModel=t.TechnicianModel=t.PartnerModel=t.UserAddressModel=t.UserModel=void 0;var o=r(8347);Object.defineProperty(t,"UserModel",{enumerable:!0,get:function(){return o.default}});var n=r(5323);Object.defineProperty(t,"UserAddressModel",{enumerable:!0,get:function(){return n.default}});var i=r(33);Object.defineProperty(t,"PartnerModel",{enumerable:!0,get:function(){return i.default}});var s=r(3171);Object.defineProperty(t,"TechnicianModel",{enumerable:!0,get:function(){return s.default}});var a=r(9857);Object.defineProperty(t,"RoleModel",{enumerable:!0,get:function(){return a.default}});var c=r(410);Object.defineProperty(t,"MenuModel",{enumerable:!0,get:function(){return c.default}});var l=r(4745);Object.defineProperty(t,"ModuleModel",{enumerable:!0,get:function(){return l.default}});var d=r(138);Object.defineProperty(t,"PermissionModel",{enumerable:!0,get:function(){return d.default}});var u=r(945);Object.defineProperty(t,"CustomerModel",{enumerable:!0,get:function(){return u.default}});var p=r(1599);Object.defineProperty(t,"ClaimModel",{enumerable:!0,get:function(){return p.default}});var f=r(1714);Object.defineProperty(t,"IrisModel",{enumerable:!0,get:function(){return f.default}});var y=r(9709);Object.defineProperty(t,"ChargeModel",{enumerable:!0,get:function(){return y.default}});var m=r(5e3);Object.defineProperty(t,"InvoiceModel",{enumerable:!0,get:function(){return m.default}})},1960:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2047:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2067:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SampleModel=void 0;const o=r(7861);class n extends o.Model{static get jsonSchema(){return{type:"object",required:["name","batch"],properties:{id:{type:"integer"},name:{type:"string"},batch:{type:"integer"},migration_time:{type:"string",format:"date-time"}}}}}t.SampleModel=n,n.tableName="knex_migrations",n.idColumn="id"},2087:function(e,t,r){var o,n=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.OtpService=void 0;const s=r(1813),a=r(8749),c=r(4754),l=r(1514);let d=class{constructor(e){this.expiresInMs=c(e.get("OTP_EXPIRES_IN","5m")),this.maxAttempts=parseInt(e.get("OTP_MAX_ATTEMPTS","5")),isNaN(this.maxAttempts)&&(this.maxAttempts=5),isNaN(this.expiresInMs)&&(this.expiresInMs=3e5)}generateOtpCode(){return((0,a.randomBytes)(3).readUIntBE(0,3)%1e6).toString().padStart(6,"0")}generateOtp(e){let t;if(void 0===e)t=this.expiresInMs;else if("number"==typeof e)t=1e3*e;else{if("string"!=typeof e)throw new s.BadRequestException("Invalid expiresIn format");t=c(e)}const r=this.generateOtpCode(),o=new Date(Date.now()+t);new Date;return{otpCode:r,otpExpiredAt:o}}verifyOtp(e,t,r=5){if(!e.otpCode)throw new s.BadRequestException("OTP code is required");if(!e.email&&!e.phone)throw new s.BadRequestException("Email or phone is required for verification");if(!t)throw new s.BadRequestException("OTP not found");if(new Date>t.otpExpiredAt)throw new s.BadRequestException("OTP has expired");if(t.otpCode!==e.otpCode)throw new s.BadRequestException("Invalid OTP code")}};t.OtpService=d,t.OtpService=d=n([(0,s.Injectable)(),i("design:paramtypes",["function"==typeof(o=void 0!==l.ConfigService&&l.ConfigService)?o:Object])],d)},2152:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.CustomerModule=void 0;const n=r(1813),i=r(5033);let s=class{};t.CustomerModule=s,t.CustomerModule=s=o([(0,n.Module)({providers:[i.CustomerService],exports:[i.CustomerService]})],s)},2202:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.knex=void 0,t.knex=r(4413)},2213:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.SampleService=void 0;const i=r(1813),s=r(2067);let a=class{constructor(){}async getMigrationHistory(){return await s.SampleModel.query().orderBy("migration_time","desc").limit(5)}async getLastBatchNo(){return await s.SampleModel.query().max("batch as maxBatch").first()}};t.SampleService=a,t.SampleService=a=o([(0,i.Injectable)(),n("design:paramtypes",[])],a)},2386:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.UserModule=void 0;const n=r(1813),i=r(3147);let s=class{};t.UserModule=s,t.UserModule=s=o([(0,n.Module)({providers:[i.UserService],exports:[i.UserService]})],s)},2459:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2485:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.safeTrim=function(e){return"string"==typeof e?e.trim():e}},2490:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(7652),t),n(r(4773),t),n(r(9144),t)},2520:e=>{e.exports=require("@nestjs/swagger")},2585:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2599:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.randomStrings=function(e=""){const t=Buffer.alloc(4);return t.writeInt32LE(Date.now()/1e3),e+Buffer.concat([t,(0,o.randomBytes)(11)],15).toString("hex").toUpperCase()};const o=r(7598)},2717:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},2848:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(823),t),n(r(7118),t)},2935:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(5318),t),n(r(2599),t)},2982:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.DatabaseModule=void 0;const n=r(1813),i=r(7435);let s=class{};t.DatabaseModule=s,t.DatabaseModule=s=o([(0,n.Global)(),(0,n.Module)({providers:i.databaseProviders,exports:i.databaseProviders})],s)},3020:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.paginationExtractOffsetAndLimit=function(e){const t=!e?.page||e.page<=0||"number"!=typeof e.page||isNaN(e.page)?1:e.page,r=!e?.count||e.count<=0||"number"!=typeof e.count||isNaN(e.count)?10:e.count;return{offset:(t-1)*r,limit:r}},t.paginationSanitizeFilterValue=function e(t,r){switch(typeof t){case"undefined":case"boolean":case"string":case"number":return t;case"object":if(null===t)return null;if(!(t instanceof Array))return t instanceof Date?t:JSON.stringify(t);switch(r){case"in":case"notIn":return t.map(t=>e(t,r));case"equal":case"notEqual":case"like":case"lessThan":case"greaterThan":case"isNull":case"isNotNull":return String(t);default:return t.slice(0,2).map(e)}case"symbol":case"function":case"bigint":return String(t)}},t.paginationSanitizeSortValue=function(e){if("string"==typeof e)return e.toUpperCase();return"ASC"},t.paginationSanitizeRegex=function(e){return"string"!=typeof e?"":e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},t.simplePaginatedList=async function(e,t){const{filters:r,page:n,count:i,sorts:s}=t;r&&(0,o.applyFilters)(r,e);const a=await e.resultSize();s?(0,o.applySorts)(s,e):(0,o.applySorts)([{id:"DESC"}],e);return(0,o.applyPagination)({page:n,count:i},e),{page:n,count:i,items:await e.execute(),total:a}};const o=r(4413)},3037:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3120:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},3147:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.UserService=void 0;const n=r(1813),i=r(1944);let s=class{constructor(){this.logger=new n.Logger("UserService")}async listAllUsers(){try{return await i.UserModel.query().select("*")}catch(e){throw new n.BadRequestException("Failed to fetch users")}}async findUserById(e){try{const t=await i.UserModel.query().findById(e);if(!t)throw new n.NotFoundException(`User with ID ${e} not found`);return t}catch(e){if(e instanceof n.NotFoundException)throw e;throw new n.BadRequestException("Failed to fetch user")}}async createUser(e){try{if(!e.firstName||!e.lastName||!e.accountName)throw new n.BadRequestException("First name, last name, and account name are required");return await i.UserModel.query().insert({...e})}catch(e){if(e instanceof n.BadRequestException)throw e;throw new n.BadRequestException("Failed to create user")}}async updateUser(e,t){try{if(!await this.findUserById(e))throw new n.NotFoundException(`User with ID ${e} not found`);await i.UserModel.query().findById(e).patch({...t});return await i.UserModel.query().findById(e)}catch(e){if(e instanceof n.NotFoundException||e instanceof n.BadRequestException)throw e;throw new n.BadRequestException("Failed to update user")}}async deleteUser(e){try{if(!await this.findUserById(e))throw new n.NotFoundException(`User with ID ${e} not found`);return await i.UserModel.query().findById(e).del(),{message:`User with ID ${e} deleted successfully`,id:e}}catch(e){if(e instanceof n.NotFoundException||e instanceof n.BadRequestException)throw e;throw new n.BadRequestException("Failed to delete user")}}async searchByEmail(e){try{if(!e)throw new n.BadRequestException("Email is required");return await i.UserModel.query().where("email","ilike",`%${e}%`)}catch(e){if(e instanceof n.BadRequestException)throw e;throw new n.BadRequestException("Failed to search users")}}async searchByName(e,t){try{if(!e)throw new n.BadRequestException("First name is required");let r=i.UserModel.query().where("firstName","ilike",`%${e}%`);t&&(r=r.orWhere("lastName","ilike",`%${t}%`));return await r}catch(e){if(e instanceof n.BadRequestException)throw e;throw new n.BadRequestException("Failed to search users")}}async getUsersWithPagination(e=1,t=10){try{if(e<1||t<1)throw new n.BadRequestException("Page and limit must be greater than 0");const r=(e-1)*t,o=i.UserModel.query(),s=await o.resultSize();return{data:await o.offset(r).limit(t),total:s,page:e,limit:t}}catch(e){if(e instanceof n.BadRequestException)throw e;throw new n.BadRequestException("Failed to fetch users")}}async getUsersByRoleId(e){try{if(!e)throw new n.BadRequestException("Role ID is required");return await i.UserModel.query().where("roleId",e)}catch(e){if(e instanceof n.BadRequestException)throw e;throw new n.BadRequestException("Failed to fetch users by role")}}async createUserFromCustomers(e){this.logger.log(`Create new user from customer ids: ${e.map(e=>e.id)}`);const t={email:"email",accountName:"accountName",firstName:"firstName",middleName:"middleName",lastName:"lastName",mobilePhone:"mobilePhone"},r={};if(e.forEach(e=>{Object.entries(t).filter(([e,t])=>!r[t]).map(([t,o])=>{e[t]&&(r[o]=e[t])})}),r.roleId=(await i.RoleModel.query().select("id").where("slug","customer").first())?.id,r.loginAttempts=0,r.otpCodeAttempt=0,!r.roleId)return this.logger.error('Fail create user from customer, no "customer" defined'),Promise.reject(new n.InternalServerErrorException("No customer role defined"));if(!r.email&&!r.mobilePhone)return this.logger.warn(`Fail create user, merged data: ${JSON.stringify(r)}`),Promise.reject(new n.BadRequestException("Create user from customer requires email or phone number"));const o=await i.UserModel.query().insert(r).returning("*").withGraphFetched("role").first();return await i.CustomerModel.query().where(e=>{r.email&&e.where("email",r.email),r.mobilePhone&&e.orWhere("mobilePhone",r.mobilePhone)}).update({userId:o.id}),o}};t.UserService=s,t.UserService=s=o([(0,n.Injectable)()],s)},3171:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(7861);class n extends o.Model{}n.tableName="Technicians",n.idColumn="id",n.jsonSchema={type:"object",properties:{id:{type:"integer"},userId:{type:"integer"},nsc:{type:"string"},startDate:{type:["string","null"]},endDate:{type:["string","null"]},password:{type:"string"},forgotPassword:{type:"string"},activationCode:{type:"string"},loginAttempts:{type:"integer"},lockUntil:{type:["string","null"]},lastLogin:{type:["string","null"]},lastNotifUpdatePassword:{type:["string","null"]},lastUpdatePassword:{type:["string","null"]}}},t.default=n},3219:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ValidationException=t.ApiException=void 0;const o=r(1813),n=r(9856);class i extends o.HttpException{constructor(e=o.HttpStatus.INTERNAL_SERVER_ERROR,t,r,i){const s={statusCode:e,message:n.STATUS_CODES[e]||"Unknown Error",cause:r,description:i,source:process.env.APP_NAME||"unknown"};t&&(s.errorDetails=Array.isArray(t)?t:[t]),super(o.HttpException.createBody(s),e)}getResponse(){return super.getResponse()}}t.ApiException=i;class s extends i{constructor(e,t=o.HttpStatus.BAD_REQUEST){const r=Object.create(null);super(t,s.flattenValidationErrors(e,r)),this.errorFields={},this.errorFields=r}static error(e,t,r="invalid"){const o={};return o.property=e,o.constraints={[r]:t},new s([o])}static flattenValidationErrors(e,t){return e.map(e=>this.mapChildrenToValidationErrors(e)).flat().filter(e=>!!e.constraints).map(e=>{const r=Object.values(e.constraints);return t[e.property]=r,r}).flat()}static mapChildrenToValidationErrors(e,t){if(!e.children||!e.children.length)return[e];const r=[];t=t?`${t}.${e.property}`:e.property;for(const o of e.children)o.children&&o.children.length&&r.push(...this.mapChildrenToValidationErrors(o,t)),r.push(this.prependConstraintsWithParentProp(t,o));return r}static prependConstraintsWithParentProp(e,t){const r={};for(const o in t.constraints)r[o]=`${e}.${t.constraints[o]}`;return{...t,constraints:r}}}t.ValidationException=s},3487:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(7326),t),n(r(944),t),n(r(4338),t),n(r(467),t)},3523:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateInvoiceDto=t.CreateInvoiceDto=void 0;const i=r(6325),s=r(2520);class a{}t.CreateInvoiceDto=a,o([(0,s.ApiProperty)({description:"Work Order ID associated with the invoice",example:101}),(0,i.IsNotEmpty)(),(0,i.IsNumber)(),n("design:type",Number)],a.prototype,"workOrderId",void 0),o([(0,s.ApiProperty)({description:"Invoice Number",example:"INV-2023-001"}),(0,i.IsNotEmpty)(),(0,i.IsString)(),n("design:type",String)],a.prototype,"invoiceNumber",void 0),o([(0,s.ApiProperty)({description:"Total amount of the invoice",example:1500}),(0,i.IsNotEmpty)(),(0,i.IsNumber)(),(0,i.Min)(0),n("design:type",Number)],a.prototype,"totalAmount",void 0),o([(0,s.ApiPropertyOptional)({description:"Issue Date",example:"2023-10-27"}),(0,i.IsOptional)(),(0,i.IsString)(),n("design:type",String)],a.prototype,"issueDate",void 0),o([(0,s.ApiPropertyOptional)({description:"Due Date",example:"2023-11-27"}),(0,i.IsOptional)(),(0,i.IsString)(),n("design:type",String)],a.prototype,"dueDate",void 0),o([(0,s.ApiProperty)({description:"Status of the invoice",example:"Issued"}),(0,i.IsNotEmpty)(),(0,i.IsString)(),n("design:type",String)],a.prototype,"status",void 0);class c{}t.UpdateInvoiceDto=c,o([(0,s.ApiPropertyOptional)({description:"Total amount of the invoice",example:1600}),(0,i.IsOptional)(),(0,i.IsNumber)(),(0,i.Min)(0),n("design:type",Number)],c.prototype,"totalAmount",void 0),o([(0,s.ApiPropertyOptional)({description:"Issue Date",example:"2023-10-27"}),(0,i.IsOptional)(),(0,i.IsString)(),n("design:type",String)],c.prototype,"issueDate",void 0),o([(0,s.ApiPropertyOptional)({description:"Due Date",example:"2023-11-27"}),(0,i.IsOptional)(),(0,i.IsString)(),n("design:type",String)],c.prototype,"dueDate",void 0),o([(0,s.ApiPropertyOptional)({description:"Status of the invoice",example:"Paid"}),(0,i.IsOptional)(),(0,i.IsString)(),n("design:type",String)],c.prototype,"status",void 0)},3691:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(4878),t),n(r(9347),t),n(r(8446),t),n(r(2459),t)},3716:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.WorkOrderPriorityEnum=void 0,function(e){e.None="None",e.Low="Low",e.Medium="Medium",e.High="High"}(r||(t.WorkOrderPriorityEnum=r={}))},4014:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.PaginationValidator=t.PaginationTransformer=t.PaginationAdapter=void 0,t.PaginationAdapter=r(2202),t.PaginationTransformer=r(581),t.PaginationValidator=r(1916),n(r(5084),t),n(r(7621),t),n(r(3020),t)},4218:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(7861),n=r(7729);class i extends o.Model{}i.tableName=n.constants.TableName.WorkOrderSubStatus,i.idColumn="id",i.jsonSchema={type:"object",properties:{id:{type:"integer"},workOrderStatusId:{type:"integer"},slug:{type:"string"},name:{type:"string"},createdAt:{type:"string"},createdBy:{type:"integer"}}},t.default=i},4222:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CoreInterceptor=void 0;const o=r(9856),n=r(573),i=r(8491);t.CoreInterceptor=class{constructor(){this.source=process.env.APP_NAME||"unknown",!process.env.APP_NAME&&process.env.PACKAGE_NAME&&(this.source=process.env.PACKAGE_NAME,this.source.includes("/")&&(this.source=this.source.replace(/^[^/]+\//,""))),process.env.PACKAGE_VERSION&&(this.source+=`@${process.env.PACKAGE_VERSION}`)}intercept(e,t){return t.handle().pipe((0,n.map)(t=>{const r=e.switchToHttp().getRequest().res,n=r?.statusCode||200,s={statusCode:n,message:o.STATUS_CODES[n]||"Unknown Status",source:this.source};return t instanceof i.InterceptorResponse?(Object.assign(s,t.getResponse()),s.statusCode!=n&&(r.statusCode=s.statusCode)):s.result=t,s}))}}},4246:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},4338:function(e,t,r){var o,n,i,s,a,c=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},l=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.UpdatePartnerDto=t.CreatePartnerDto=t.UpdatePartnerAccountInformationDto=t.PartnerAccountInformationDto=t.PartnerAddressDto=void 0;const d=r(6325),u=r(284),p=r(6088),f=r(5007),y=r(2485);class m{}t.PartnerAddressDto=m,c([(0,d.IsString)({message:"Country must be a string"}),(0,d.IsOptional)(),(0,u.Transform)(({value:e})=>(0,y.safeTrim)(e)),l("design:type",String)],m.prototype,"country",void 0),c([(0,d.IsString)({message:"Province must be a string"}),(0,d.IsOptional)(),(0,u.Transform)(({value:e})=>(0,y.safeTrim)(e)),l("design:type",String)],m.prototype,"province",void 0),c([(0,d.IsString)({message:"City must be a string"}),(0,d.IsOptional)(),(0,u.Transform)(({value:e})=>(0,y.safeTrim)(e)),l("design:type",String)],m.prototype,"city",void 0),c([(0,d.IsString)({message:"Sub-district must be a string"}),(0,d.IsOptional)(),(0,u.Transform)(({value:e})=>(0,y.safeTrim)(e)),l("design:type",String)],m.prototype,"subDistrict",void 0),c([(0,d.IsString)({message:"Village must be a string"}),(0,d.IsOptional)(),(0,u.Transform)(({value:e})=>(0,y.safeTrim)(e)),l("design:type",String)],m.prototype,"village",void 0),c([(0,d.IsInt)({message:"Postal code must be a string"}),(0,d.IsOptional)(),l("design:type",Number)],m.prototype,"postalCode",void 0),c([(0,d.IsString)({message:"Street must be a string"}),(0,d.IsOptional)(),(0,u.Transform)(({value:e})=>(0,y.safeTrim)(e)),l("design:type",String)],m.prototype,"street",void 0);class g{}t.PartnerAccountInformationDto=g,c([(0,d.IsString)({message:"name must be a string"}),(0,d.IsNotEmpty)({message:"name should not be empty"}),(0,u.Transform)(({value:e})=>(0,y.safeTrim)(e)),l("design:type",String)],g.prototype,"name",void 0),c([(0,d.IsEnum)(p.SalutationEnum,{message:"salutation must be a valid enum value"}),l("design:type","function"==typeof(o=void 0!==p.SalutationEnum&&p.SalutationEnum)?o:Object)],g.prototype,"salutation",void 0),c([(0,d.IsEmail)({},{message:"email must be a valid email address"}),(0,u.Transform)(({value:e})=>(0,y.safeTrim)(e)),l("design:type",String)],g.prototype,"email",void 0),c([(0,d.IsAlphanumeric)(),(0,d.Length)(8,15,{message:"businessPhone must be between 8 and 15 characters long"}),(0,d.IsOptional)(),l("design:type",String)],g.prototype,"businessPhone",void 0),c([(0,d.IsAlphanumeric)(),(0,d.Length)(8,15,{message:"mobilePhone must be between 8 and 15 characters long"}),(0,d.IsNotEmpty)({message:"mobilePhone should not be empty"}),l("design:type",String)],g.prototype,"mobilePhone",void 0),c([(0,d.IsString)({message:"suffix must be a string"}),(0,d.IsOptional)(),(0,u.Transform)(({value:e})=>(0,y.safeTrim)(e)),l("design:type",String)],g.prototype,"suffix",void 0),c([(0,d.IsEnum)(p.GenderEnum,{message:"gender must be a valid enum value"}),l("design:type","function"==typeof(n=void 0!==p.GenderEnum&&p.GenderEnum)?n:Object)],g.prototype,"gender",void 0),c([(0,d.IsBoolean)({message:"status must be a boolean"}),l("design:type",Boolean)],g.prototype,"status",void 0),c([(0,d.IsString)({message:"password must be a string"}),(0,d.IsNotEmpty)({message:"password should not be empty"}),(0,d.Matches)(/^(?=.*[A-Z])(?=.*[0-9]).{8,}$/,{message:"password must be at least 8 characters long and contain at least one uppercase letter and one number"}),(0,u.Transform)(({value:e})=>e?.trim()),l("design:type",String)],g.prototype,"password",void 0),c([(0,d.IsString)({message:"taxPayerId must be a string"}),(0,d.IsOptional)(),(0,u.Transform)(({value:e})=>(0,y.safeTrim)(e)),l("design:type",String)],g.prototype,"taxPayerId",void 0),c([(0,d.IsString)({message:"remark must be a string"}),(0,d.IsOptional)(),(0,u.Transform)(({value:e})=>(0,y.safeTrim)(e)),l("design:type",String)],g.prototype,"remark",void 0),c([(0,d.IsNumber)({},{message:"roleId must be a number"}),(0,d.IsNotEmpty)({message:"roleId should not be empty"}),l("design:type",Number)],g.prototype,"roleId",void 0),c([(0,d.IsNumber)({},{message:"integrationId must be a number"}),(0,d.IsOptional)(),l("design:type",Number)],g.prototype,"integrationId",void 0),c([(0,d.IsNumber)({},{message:"territoryId must be a number"}),(0,d.IsNotEmpty)({message:"territoryId should not be empty"}),l("design:type",Number)],g.prototype,"territoryId",void 0),c([(0,d.IsNumber)({},{message:"nscBranchId must be a number"}),(0,d.IsOptional)(),l("design:type",Number)],g.prototype,"nscBranchId",void 0),c([(0,d.IsDate)({message:"startDate must be a valid date"}),(0,d.IsOptional)(),(0,u.Type)(()=>Date),l("design:type","function"==typeof(i="undefined"!=typeof Date&&Date)?i:Object)],g.prototype,"startDate",void 0),c([(0,d.IsDate)({message:"endDate must be a valid date"}),(0,d.IsOptional)(),(0,u.Type)(()=>Date),l("design:type","function"==typeof(s="undefined"!=typeof Date&&Date)?s:Object)],g.prototype,"endDate",void 0),c([(0,d.IsString)({message:"technicalSkill must be a string"}),(0,d.IsOptional)(),(0,u.Transform)(({value:e})=>(0,y.safeTrim)(e)),l("design:type",String)],g.prototype,"technicalSkill",void 0);class h extends((0,f.PartialType)((0,f.OmitType)(g,["password"]))){}t.UpdatePartnerAccountInformationDto=h;class b{}t.CreatePartnerDto=b,c([(0,d.ValidateNested)(),(0,u.Type)(()=>g),(0,d.IsNotEmpty)({message:"Account information should not be empty"}),l("design:type",g)],b.prototype,"accountInformation",void 0),c([(0,d.ValidateNested)(),(0,u.Type)(()=>m),(0,d.IsOptional)(),l("design:type",m)],b.prototype,"billingAddressInformation",void 0),c([(0,d.ValidateNested)(),(0,u.Type)(()=>m),(0,d.IsOptional)(),l("design:type",m)],b.prototype,"mailingAddressInformation",void 0);class v{}t.UpdatePartnerDto=v,c([(0,d.ValidateNested)(),(0,u.Type)(()=>h),(0,d.IsOptional)(),l("design:type","function"==typeof(a="undefined"!=typeof Partial&&Partial)?a:Object)],v.prototype,"accountInformation",void 0),c([(0,d.ValidateNested)(),(0,u.Type)(()=>m),(0,d.IsOptional)(),l("design:type",m)],v.prototype,"billingAddressInformation",void 0),c([(0,d.ValidateNested)(),(0,u.Type)(()=>m),(0,d.IsOptional)(),l("design:type",m)],v.prototype,"mailingAddressInformation",void 0)},4383:e=>{e.exports=require("fs")},4413:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isKnexBuilder=function(e){return"QueryBuilder"!=e.constructor?.name},t.applyOperatorValue=s,t.applySorts=function(e,t){if(void 0===t)throw new Error("Invalid builder object");for(const r of e)for(const[e,o]of Object.entries(r))t.orderBy(e,o);return t},t.applyFilters=function e(t,r){if(void 0===r)throw new Error("Invalid builder object");if(Array.isArray(t))t.forEach(t=>{r.orWhere(r=>{e(t,r)})});else if(t instanceof Map)t.forEach((e,t)=>{s(r,e,t)});else{if(!(0,o.isPlainObject)(t))throw new Error(`Unhandled filter type: ${"object"==typeof t&&null!==t?t.constructor.name:typeof t}`);Object.entries(t).forEach(([t,o])=>{"_searchGroup"===t&&Array.isArray(o)?r.where(t=>{o.forEach(r=>{t.orWhere(t=>{e(r,t)})})}):s(r,o,t)})}return r},t.applyPagination=function(e,t){const{offset:r,limit:o}=(0,i.paginationExtractOffsetAndLimit)(e);return t.offset(r).limit(o)};const o=r(7546),n=r(5448),i=r(3020);function s(e,t,r){let o;switch("object"!=typeof t&&(t={op:"equal",value:t}),o="in"===t.op||"notIn"===t.op?(0,i.paginationSanitizeFilterValue)(t.value,t.op):(0,i.paginationSanitizeFilterValue)(t.value),t.op){case"equal":case"notEqual":case"lessThan":case"greaterThan":return e.where(r,n.operatorMapSQL[t.op],o);case"between":return e.where(r,t.op,o);case"like":return e.where(r,"ilike",`%${o}%`);case"isNull":return e.whereNull(r);case"isNotNull":return e.whereNotNull(r);case"in":return e.whereIn(r,o);case"notIn":return e.whereNotIn(r,o);default:throw new Error(`Invalid filter operator: ${String(t.op)}`)}}},4424:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.TechnicianModule=void 0;const n=r(1813),i=r(6329);let s=class{};t.TechnicianModule=s,t.TechnicianModule=s=o([(0,n.Module)({providers:[i.TechnicianService],exports:[i.TechnicianService]})],s)},4602:e=>{e.exports=require("@nestjs/passport")},4626:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},4671:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.checkAccess=function(e,t){if(e&&!t)return!1;if(!e)return!0;for(const r in Object.keys(e)){const o=e[r],n=t[r];if(!n||!Array.isArray(n))return!1;for(const e of o)if(!n.includes(e))return!1}return!0},t.getMissingAccess=function(e,t){if(e&&!t)return e;const r={};if(!e)return r;for(const o of Object.keys(e)){const n=e[o],i=t[o];if(i&&Array.isArray(i))for(const e of n)i.includes(e)||(o in r||(r[o]=[]),r[o].push(e));else r[o]=n}return r},t.stringifyAccess=function(e){const t=[];for(const r in e)t.push(e[r].join(", ")+" on module "+r);return t.join(" AND ")}},4724:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},4745:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(7861);class n extends o.Model{}n.tableName="Modules",n.idColumn="id",n.jsonSchema={type:"object",properties:{id:{type:"integer"},slug:{type:"string"},moduleName:{type:"string"},description:{type:"string"},order:{type:"integer"},permissions:{type:"array"},permissionsHash:{type:"string"},menus:{type:"array"},menusHash:{type:"string"},isActive:{type:"boolean"}}},t.default=n},4754:e=>{e.exports=require("ms")},4773:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.ChargeService=void 0;const n=r(1813),i=r(9709),s=r(4014);let a=class{async listCharges(e,t,r){const o=i.default.query();return r&&o.where("workOrderId",r),t&&o.where("name","like",`%${t}%`),e?(0,s.simplePaginatedList)(o,e):o}async getChargesByWorkOrder(e){return i.default.query().where("workOrderId",e)}async getChargeById(e){const t=await i.default.query().findById(e);if(!t)throw new n.NotFoundException(`Charge with ID ${e} not found`);return t}async createCharge(e){return i.default.query().insert(e)}async updateCharge(e,t){return(await this.getChargeById(e)).$query().patchAndFetch(t)}async deleteCharge(e){if(0===await i.default.query().deleteById(e))throw new n.NotFoundException(`Charge with ID ${e} not found`);return{success:!0,id:e}}};t.ChargeService=a,t.ChargeService=a=o([(0,n.Injectable)()],a)},4865:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.CreateWorkOrderUseCase=void 0;const n=r(1813),i=r(6245);let s=class{constructor(){this.logger=new n.Logger("CreateWorkOrderUseCase")}async execute(e){return this.params=e,this.data=this.params.data,await this.setData(),await this.insertData(),this.result}async setData(){this.data.createdBy=this.params.token.userId,this.logger.log(`CreateWorkOrderUseCase: setData executed with data: ${JSON.stringify(this.data)}`)}async insertData(){const e=await i.WorkOrderModel.query().insert({...this.data});this.result=e}};t.CreateWorkOrderUseCase=s,t.CreateWorkOrderUseCase=s=o([(0,n.Injectable)()],s)},4873:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.WorkOrderService=void 0;const n=r(1813),i=r(4865),s=r(1187),a=r(6172);let c=class{async create(e,t){const r=new i.CreateWorkOrderUseCase;return await r.execute({data:e,token:t})}async findAll(){const e=new s.GetAllWorkOrderUseCase;return await e.execute()}async softDelete(e,t){const r=new a.DeleteWorkOrderUseCase;return await r.execute({id:e,token:t})}};t.WorkOrderService=c,t.WorkOrderService=c=o([(0,n.Injectable)()],c)},4878:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},5e3:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(7861);class n extends o.Model{}n.tableName="Invoices",n.idColumn="id",n.jsonSchema={type:"object",required:["invoiceNumber","workOrderId","totalAmount","status"],properties:{id:{type:"integer"},invoiceNumber:{type:"string"},workOrderId:{type:"integer"},totalAmount:{type:"number"},issueDate:{type:["string","null"]},dueDate:{type:["string","null"]},status:{type:"string"},createdAt:{type:"string"},updatedAt:{type:"string"},createdBy:{type:"integer"},updatedBy:{type:"integer"}}},t.default=n},5007:e=>{e.exports=require("@nestjs/mapped-types")},5033:function(e,t,r){var o,n=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},s=this&&this.__param||function(e,t){return function(r,o){t(r,o,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CustomerService=void 0;const a=r(1813),c=r(1944),l=r(7976),d=r(1706),u=r(6088),p=r(9044),f=r(4014),y=r(4413);let m=class{constructor(e){this.logger=e,this.CUSTOMER_SEARCH_COLUMNS=["idText","name","email","mobilePhone","createdByName","updatedByName"],e||(this.logger=new a.Logger("CustomerService"))}async checkEmailExists(e,t){let r=c.CustomerModel.query().where("email",e).where("deleteFlag",!1);t&&(r=r.whereNot("id",t));return!!await r.first()}async checkMobilePhoneExists(e,t){let r=c.CustomerModel.query().where("mobilePhone",e).where("deleteFlag",!1);t&&(r=r.whereNot("id",t));return!!await r.first()}async checkBusinessPhoneExists(e,t){let r=c.UserModel.query().where("businessPhone",e);t&&(r=r.whereNot("id",t));return!!await r.first()}async validateUniqueFieldsForCreate(e){const t={};if(e.email){await this.checkEmailExists(e.email)&&(t.email="email is exist")}if(e.mobilePhone){await this.checkMobilePhoneExists(e.mobilePhone)&&(t.mobilePhone="mobile phone is exist")}if(e.businessPhone){await this.checkBusinessPhoneExists(e.businessPhone)&&(t.businessPhone="business phone is exist")}if(Object.keys(t).length>0){const e=[];throw Object.entries(t).forEach(([t,r])=>{e.push({property:t,constraints:{unique:r}})}),new p.ValidationException(e)}}async validateUniqueFieldsForUpdate(e,t){const r=await c.CustomerModel.query().findById(e);if(!r)throw new a.NotFoundException(`Customer with ID ${e} not found`);const o={};if(t.email){await this.checkEmailExists(t.email,e)&&(o.email="email is exist")}if(t.mobilePhone){await this.checkMobilePhoneExists(t.mobilePhone,e)&&(o.mobilePhone="mobile phone is exist")}if(t.businessPhone){await this.checkBusinessPhoneExists(t.businessPhone,r.userId)&&(o.businessPhone="business phoneis exist")}if(Object.keys(o).length>0){const e=[];throw Object.entries(o).forEach(([t,r])=>{e.push({property:t,constraints:{unique:r}})}),new p.ValidationException(e)}}buildCustomersSubquery(){return c.CustomerModel.query().join("Users","Customers.userId","=","Users.id").leftJoin("Users as CreatedByUser","Customers.createdBy","=","CreatedByUser.id").leftJoin("Users as UpdatedByUser","Customers.updatedBy","=","UpdatedByUser.id").where("Customers.deleteFlag",!1).select("Customers.id","Customers.email","Customers.firstName","Customers.middleName","Customers.lastName","Customers.mobilePhone","Customers.membershipType","Customers.createdAt","Customers.updatedAt","Users.status",c.CustomerModel.raw('CAST("Customers"."id" AS TEXT) as "idText"'),c.CustomerModel.raw('CONCAT("Customers"."firstName", \' \', COALESCE("Customers"."middleName", \'\'), \' \', "Customers"."lastName") as "name"'),c.CustomerModel.raw('CASE \n          WHEN COALESCE("CreatedByUser"."firstName", \'\') = \'\' \n            AND COALESCE("CreatedByUser"."middleName", \'\') = \'\' \n            AND COALESCE("CreatedByUser"."lastName", \'\') = \'\' \n          THEN \'\'\n          ELSE TRIM(CONCAT(COALESCE("CreatedByUser"."firstName", \'\'), \' \', COALESCE("CreatedByUser"."middleName", \'\'), \' \', COALESCE("CreatedByUser"."lastName", \'\')))\n        END as "createdByName"'),c.CustomerModel.raw('CASE \n          WHEN COALESCE("UpdatedByUser"."firstName", \'\') = \'\' \n            AND COALESCE("UpdatedByUser"."middleName", \'\') = \'\' \n            AND COALESCE("UpdatedByUser"."lastName", \'\') = \'\' \n          THEN \'\'\n          ELSE TRIM(CONCAT(COALESCE("UpdatedByUser"."firstName", \'\'), \' \', COALESCE("UpdatedByUser"."middleName", \'\'), \' \', COALESCE("UpdatedByUser"."lastName", \'\')))\n        END as "updatedByName"'))}async listAllCustomers(e,t){let r,o;this.logger.log("initialization query - building subquery");const n=c.CustomerModel.query().from(this.buildCustomersSubquery().as("subquery"));this.logger.log("count data from subquery");const i=c.CustomerModel.query().from(this.buildCustomersSubquery().as("subquery")).count("* as count");if(e.filters){this.logger.log("apply filters data");const t=(0,d.processSearchFilterWithColumns)(e.filters,this.CUSTOMER_SEARCH_COLUMNS);(0,y.applyFilters)(t,n),(0,y.applyFilters)(t,i)}e.sorts&&(this.logger.log("apply sort data"),(0,y.applySorts)(e.sorts,n)),e instanceof f.PaginationDto&&(r=e.page,o=e.count,this.logger.log("apply pagination data"),(0,y.applyPagination)({page:r,count:o},n));const[s,a]=await Promise.all([n,i]);return{page:r,count:o,total:parseInt(a[0]?.count),items:s}}async findCustomerById(e,t){const r=await c.CustomerModel.query().findOne({id:e,deleteFlag:!1});if(!r)throw new a.NotFoundException(`Customer with ID ${e} not found`);const o=await c.UserModel.query().findById(r.userId);if(!o)throw new a.NotFoundException(`User with ID ${r.userId} not found`);const n={name:`${o.firstName} ${o.middleName||""} ${o.lastName}`.trim(),salutation:o.salutation,email:o.email,businessPhone:o.businessPhone,mobilePhone:o.mobilePhone,suffix:o.suffix,gender:o.gender,status:o.status,memberType:r.membershipType,remark:o.remark},i=await c.UserAddressModel.query().where("userId",r.userId).where("addressType",u.AddressTypeEnum.Billing).orderBy("id","desc").first(),s=await c.UserAddressModel.query().where("userId",r.userId).where("addressType",u.AddressTypeEnum.Mailing).orderBy("id","desc").first();return{accountInformation:n,billingAddressInformation:i?{country:i.country,province:i.stateOrProvince,city:i.city,subDistrict:i.subDistrict,village:i.village,postalCode:i.zipOrPostalCode,street:i.street}:{},mailingAddressInformation:s?{country:s.country,province:s.stateOrProvince,city:s.city,subDistrict:s.subDistrict,village:s.village,postalCode:s.zipOrPostalCode,street:s.street}:{}}}async createCustomer(e,t){const{accountInformation:r,billingAddressInformation:o,mailingAddressInformation:n}=e;await this.validateUniqueFieldsForCreate(r);const{firstName:i,middleName:s,lastName:a}=(0,l.splitName)(r.name),d={updatedBy:t.userId,createdBy:t.userId,updatedAt:new Date},p=await c.CustomerModel.startTransaction();try{const e=await c.UserModel.query(p).insert({firstName:i,middleName:s,lastName:a,businessPhone:r.businessPhone,mobilePhone:r.mobilePhone,gender:r.gender,status:!0,email:r.email,salutation:r.salutation,suffix:r.suffix,remark:r.remark,...d}),t=await c.CustomerModel.query(p).insert({userId:e.id,email:r.email,firstName:i,middleName:s,lastName:a,mobilePhone:r.mobilePhone,membershipType:r.membershipType,...d});return await c.UserAddressModel.query(p).insert({userId:e.id,addressType:u.AddressTypeEnum.Billing,country:o?.country,stateOrProvince:o?.province,city:o?.city,subDistrict:o?.subDistrict,village:o?.village,zipOrPostalCode:o?.postalCode,street:o?.street}),await c.UserAddressModel.query(p).insert({userId:e.id,addressType:u.AddressTypeEnum.Mailing,country:n?.country,stateOrProvince:n?.province,city:n?.city,subDistrict:n?.subDistrict,village:n?.village,zipOrPostalCode:n?.postalCode,street:n?.street}),await p.commit(),t}catch(e){throw await p.rollback(),e}}async updateCustomer(e,t,r){try{const o=await c.CustomerModel.query().findById(e);if(!o)throw new a.NotFoundException(`Customer with ID ${e} not found`);t.accountInformation&&await this.validateUniqueFieldsForUpdate(e,t.accountInformation);const n={updatedBy:r.userId,updatedAt:new Date},i=await c.CustomerModel.startTransaction();try{if(t.accountInformation){const e={...n};if(t.accountInformation.name){const{firstName:r,middleName:o,lastName:n}=(0,l.splitName)(t.accountInformation.name);r&&(e.firstName=r),o&&(e.middleName=o),n&&(e.lastName=n)}t.accountInformation.businessPhone&&(e.businessPhone=t.accountInformation.businessPhone),t.accountInformation.mobilePhone&&(e.mobilePhone=t.accountInformation.mobilePhone),t.accountInformation.gender&&(e.gender=t.accountInformation.gender),t.accountInformation.email&&(e.email=t.accountInformation.email),t.accountInformation.salutation&&(e.salutation=t.accountInformation.salutation),t.accountInformation.suffix&&(e.suffix=t.accountInformation.suffix),t.accountInformation.remark&&(e.remark=t.accountInformation.remark),await c.UserModel.query(i).findById(o.userId).patch(e)}const r={...n};if(t.accountInformation&&(t.accountInformation.email&&(r.email=t.accountInformation.email),t.accountInformation.mobilePhone&&(r.mobilePhone=t.accountInformation.mobilePhone),t.accountInformation.membershipType&&(r.membershipType=t.accountInformation.membershipType)),Object.keys(r).length>2&&await c.CustomerModel.query(i).findById(e).patch(r),t.billingAddressInformation){const e={...n};t.billingAddressInformation.country&&(e.country=t.billingAddressInformation.country),t.billingAddressInformation.province&&(e.stateOrProvince=t.billingAddressInformation.province),t.billingAddressInformation.city&&(e.city=t.billingAddressInformation.city),t.billingAddressInformation.subDistrict&&(e.subDistrict=t.billingAddressInformation.subDistrict),t.billingAddressInformation.village&&(e.village=t.billingAddressInformation.village),t.billingAddressInformation.postalCode&&(e.zipOrPostalCode=t.billingAddressInformation.postalCode),t.billingAddressInformation.street&&(e.street=t.billingAddressInformation.street),Object.keys(e).length>2&&await c.UserAddressModel.query(i).where("userId",o.userId).where("addressType",u.AddressTypeEnum.Billing).patch(e)}if(t.mailingAddressInformation){const e={...n};t.mailingAddressInformation.country&&(e.country=t.mailingAddressInformation.country),t.mailingAddressInformation.province&&(e.stateOrProvince=t.mailingAddressInformation.province),t.mailingAddressInformation.city&&(e.city=t.mailingAddressInformation.city),t.mailingAddressInformation.subDistrict&&(e.subDistrict=t.mailingAddressInformation.subDistrict),t.mailingAddressInformation.village&&(e.village=t.mailingAddressInformation.village),t.mailingAddressInformation.postalCode&&(e.zipOrPostalCode=t.mailingAddressInformation.postalCode),t.mailingAddressInformation.street&&(e.street=t.mailingAddressInformation.street),Object.keys(e).length>2&&await c.UserAddressModel.query(i).where("userId",o.userId).where("addressType",u.AddressTypeEnum.Mailing).patch(e)}await i.commit();return await c.CustomerModel.query().findById(e)}catch(e){throw await i.rollback(),e}}catch(e){if(e instanceof a.NotFoundException||e instanceof a.BadRequestException||e instanceof p.ValidationException)throw e;throw new a.BadRequestException("Failed to update customer")}}async deleteCustomer(e,t){const r=await c.CustomerModel.query().findOne({id:e,deleteFlag:!1});if(!r)throw new a.NotFoundException(`Customer with ID ${e} not found or has been deleted`);return r.deletedBy=t.userId,r.deletedAt=new Date,r.deleteFlag=!0,await r.$query().patch(),{message:`Customer with ID ${e} deleted successfully`,id:e}}async searchByEmail(e){try{if(!e)throw new a.BadRequestException("Email is required");return await c.CustomerModel.query().where("email","ilike",`%${e}%`)}catch(e){if(e instanceof a.BadRequestException)throw e;throw new a.BadRequestException("Failed to search customers")}}async searchByPhone(e){if(!e)throw new a.BadRequestException("Phone is required");return await c.CustomerModel.query().where("mobilePhone",e)}async searchByName(e,t){try{if(!e)throw new a.BadRequestException("First name is required");let r=c.CustomerModel.query().where("firstName","ilike",`%${e}%`);t&&(r=r.orWhere("lastName","ilike",`%${t}%`));return await r}catch(e){if(e instanceof a.BadRequestException)throw e;throw new a.BadRequestException("Failed to search customers")}}async getCustomersWithPagination(e=1,t=10){try{if(e<1||t<1)throw new a.BadRequestException("Page and limit must be greater than 0");const r=(e-1)*t,o=c.CustomerModel.query(),n=await o.resultSize();return{data:await o.offset(r).limit(t),total:n,page:e,limit:t}}catch(e){if(e instanceof a.BadRequestException)throw e;throw new a.BadRequestException("Failed to fetch customers")}}async findAllRelatedCustomerByEmail(e){const t=await c.CustomerModel.query().where({email:e}),r=t.filter(e=>!!e.mobilePhone).map(e=>e.mobilePhone);return r.length?c.CustomerModel.query().where(t=>{t.orWhere({email:e}),r.forEach(e=>t.orWhere({mobilePhone:e}))}):Promise.resolve(t)}async findAllRelatedCustomerByPhone(e){const t=await c.CustomerModel.query().where({mobilePhone:e}),r=t.filter(e=>!!e.email).map(e=>e.email);return r.length?c.CustomerModel.query().where(t=>{t.orWhere({mobilePhone:e}),r.forEach(e=>t.orWhere({email:e}))}):Promise.resolve(t)}};t.CustomerService=m,t.CustomerService=m=n([(0,a.Injectable)(),s(0,(0,a.Inject)(a.Logger)),s(0,(0,a.Optional)()),i("design:paramtypes",["function"==typeof(o=void 0!==a.LoggerService&&a.LoggerService)?o:Object])],m)},5057:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.RbacService=void 0;const n=r(1813),i=r(1944),s=r(3020);let a=class{async moduleList(e){return(0,s.simplePaginatedList)(i.ModuleModel.query(),e)}async roleList(e){return(0,s.simplePaginatedList)(i.RoleModel.query(),e)}async permissionList(e){return(0,s.simplePaginatedList)(i.PermissionModel.query(),e)}async createRole(e){return i.RoleModel.query().insert(e)}async getRoleById(e){return i.RoleModel.query().findById(e)}async updateRole(e,t){return i.RoleModel.query().patchAndFetchById(e,t)}async deleteRole(e){return i.RoleModel.query().deleteById(e)}};t.RbacService=a,t.RbacService=a=o([(0,n.Injectable)()],a)},5084:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(6881),t),n(r(1495),t)},5096:e=>{e.exports=require("cookie")},5285:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.JwtModuleOptionsProvider=void 0;const o=r(4383),n=r(9124);t.JwtModuleOptionsProvider={provide:n.JWT_MODULE_OPTIONS,useFactory(){const e={signOptions:{algorithm:"ES256"}};if(process.env.JWT_PRIVATE_KEY)e.privateKey=process.env.JWT_PRIVATE_KEY;else{const t=process.env.JWT_PRIVATE_KEY_FILE||"key_private.pem";(0,o.existsSync)(t)&&(e.privateKey=(0,o.readFileSync)(t,"ascii"))}if(process.env.JWT_PUBLIC_KEY?e.publicKey=process.env.JWT_PUBLIC_KEY:e.publicKey=(0,o.readFileSync)(process.env.JWT_PUBLIC_KEY_FILE||"key_public.pem","ascii"),!e.publicKey)throw new Error("Cakrawala Library [Auth Module] require at least JWT_PUBLIC_KEY");return e}}},5306:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.TokenApp=void 0,function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.CUSTOMER=1]="CUSTOMER",e[e.PARTNER=2]="PARTNER",e[e.TECHNICIAN=3]="TECHNICIAN"}(r||(t.TokenApp=r={}))},5318:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.normalizePhoneNumber=function(e){if(!e)throw new Error("Phone number empty");if("string"!=typeof e)throw new Error("Phone number is not string");if((e=e.trim()).length<6)throw new Error("Phone number to short");e.startsWith("+")?e=e.slice(1):e.startsWith("08")&&(e="62"+e.slice(2));return e.replace(/[^0-9]/g,"")}},5323:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(7861);class n extends o.Model{}n.tableName="UserAddresses",n.idColumn="id",n.jsonSchema={type:"object",properties:{id:{type:"integer"},userId:{type:"integer"},addressType:{type:"string"},country:{type:"string"},street:{type:"string"},city:{type:"string"},subDistrict:{type:"string"},stateOrProvince:{type:"string"},zipOrPostalCode:{type:"integer"},village:{type:"string"}}},t.default=n},5432:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.CreateWorkOrderDto=void 0;const i=r(6325);class s{}t.CreateWorkOrderDto=s,o([(0,i.IsString)({message:"Work order number must be a string"}),n("design:type",String)],s.prototype,"woNumber",void 0),o([(0,i.IsString)({message:"NSC Malaysia must be a string"}),n("design:type",String)],s.prototype,"nscMalaysia",void 0),o([(0,i.IsInt)({message:"Case ID must be an integer"}),(0,i.IsOptional)(),n("design:type",Number)],s.prototype,"caseId",void 0),o([(0,i.IsString)({message:"Work type must be a string"}),n("design:type",String)],s.prototype,"workType",void 0),o([(0,i.IsString)({message:"Job type must be a string"}),n("design:type",String)],s.prototype,"jobType",void 0),o([(0,i.IsInt)({message:"Work order status ID must be an integer"}),n("design:type",Number)],s.prototype,"woStatusId",void 0),o([(0,i.IsInt)({message:"Work order sub-status ID must be an integer"}),n("design:type",Number)],s.prototype,"woSubStatusId",void 0),o([(0,i.IsInt)({message:"Job reason ID must be an integer"}),n("design:type",Number)],s.prototype,"jobReasonId",void 0),o([(0,i.IsString)({message:"Priority must be a string"}),n("design:type",String)],s.prototype,"priority",void 0),o([(0,i.IsString)({message:"Subject must be a string"}),n("design:type",String)],s.prototype,"subject",void 0),o([(0,i.IsString)({message:"Description must be a string"}),n("design:type",String)],s.prototype,"description",void 0),o([(0,i.IsInt)({message:"Customer ID must be an integer"}),n("design:type",Number)],s.prototype,"customerId",void 0),o([(0,i.IsString)({message:"Customer type must be a string"}),n("design:type",String)],s.prototype,"customerType",void 0),o([(0,i.IsInt)({message:"IRIS ID must be an integer"}),n("design:type",Number)],s.prototype,"irisId",void 0),o([(0,i.IsString)({message:"Schedule date must be a string"}),n("design:type",String)],s.prototype,"scheduleDate",void 0),o([(0,i.IsInt)({message:"Claim ID must be a string"}),n("design:type",Number)],s.prototype,"claimId",void 0)},5448:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.operatorMapNoSQL=t.operatorMapSQL=void 0,t.operatorMapSQL=Object.freeze({equal:"=",notEqual:"!=",lessThan:"<",greaterThan:">"}),t.operatorMapNoSQL=Object.freeze({equal:"$eq",notEqual:"$ne",lessThan:"$lt",greaterThan:"$gt",in:"$in",notIn:"$nin"})},5487:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NoLogin=function(){return n(!1)},t.Action=function(e,t){return n(e,t)};const o=r(9124),n=(e,t)=>{const r=(r,n,i)=>{let s;return i&&(r=i.value),s=!1!==e&&{module:t,action:e},Reflect.defineMetadata(o.PERMISSION_METADATA,s,r),i||r};return r.KEY=o.PERMISSION_METADATA,r}},5635:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(7976),t),n(r(1706),t),n(r(2485),t)},5780:e=>{e.exports=require("@nestjs/microservices")},5877:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},5906:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(8072),t),n(r(345),t),n(r(9944),t),n(r(8709),t)},5947:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},5950:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(7861),n=r(7729),i=r(171);class s extends o.Model{}s.tableName=n.constants.TableName.WorkOrders,s.idColumn="id",s.jsonSchema={type:"object",properties:{id:{type:"integer"},woNumber:{type:"string"},nscMalaysia:{type:"string"},caseId:{type:"integer"},workType:{type:"string"},jobType:{type:"string"},woStatusId:{type:"integer"},woSubStatusId:{type:"integer"},jobReasonId:{type:"integer"},priority:{type:"string",enum:["Low","Medium","High"]},subject:{type:"string"},createdAt:{type:"string"},updatedAt:{type:"string"},createdBy:{type:"integer"},updatedBy:{type:"integer"},description:{type:"string"},customerId:{type:"integer"},irisId:{type:"integer"},scheduleDate:{type:"string"},claimId:{type:"integer"}}},s.relationMappings={customer:{relation:o.Model.BelongsToOneRelation,modelClass:n.CustomerModel,join:{from:`${n.constants.TableName.WorkOrders}.customerId`,to:`${n.constants.TableName.Customers}.id`}},status:{relation:o.Model.BelongsToOneRelation,modelClass:i.default,join:{from:`${n.constants.TableName.WorkOrders}.woStatusId`,to:`${n.constants.TableName.WorkOrderStatus}.id`}}},t.default=s},6046:e=>{e.exports=require("knex")},6077:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},6088:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(3716),t),n(r(9722),t),n(r(7637),t),n(r(1770),t),n(r(8703),t),n(r(919),t),n(r(1409),t),n(r(1606),t),n(r(8536),t),n(r(6381),t),n(r(6496),t),n(r(225),t),n(r(9031),t)},6150:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(4873),t),n(r(872),t),n(r(932),t),n(r(3691),t),n(r(6245),t)},6172:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.DeleteWorkOrderUseCase=void 0;const n=r(1813),i=r(6245);let s=class{constructor(){this.logger=new n.Logger("CreateWorkOrderUseCase"),this.result=!1}async execute(e){return this.params=e,await this.findData(),await this.updateData(),this.result}async findData(){this.data=await i.WorkOrderModel.query().findOne({id:this.params.id,deletedAt:null})}async updateData(){if(!this.data)throw new n.NotFoundException(`Work order with ID ${this.params.id} not found`);this.data.deletedAt=new Date,this.data.deletedBy=this.params.token.userId;const e=await i.WorkOrderModel.query().findById(this.params.id).patch(this.data);this.result=e>0}};t.DeleteWorkOrderUseCase=s,t.DeleteWorkOrderUseCase=s=o([(0,n.Injectable)()],s)},6245:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WorkOrderJobReasonModel=t.WorkOrderSubStatusModel=t.WorkOrderStatusModel=t.WorkOrderModel=void 0;var o=r(5950);Object.defineProperty(t,"WorkOrderModel",{enumerable:!0,get:function(){return o.default}});var n=r(171);Object.defineProperty(t,"WorkOrderStatusModel",{enumerable:!0,get:function(){return n.default}});var i=r(4218);Object.defineProperty(t,"WorkOrderSubStatusModel",{enumerable:!0,get:function(){return i.default}});var s=r(7359);Object.defineProperty(t,"WorkOrderJobReasonModel",{enumerable:!0,get:function(){return s.default}})},6325:e=>{e.exports=require("class-validator")},6329:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.TechnicianService=void 0;const n=r(1813),i=r(3171),s=r(8347),a=r(4014);let c=class{async listTechnicians(e,t){const r=i.default.query().withGraphFetched("user").modifyGraph("user",e=>{e.select("id","firstName","lastName","email","mobilePhone")});return t&&r.where(e=>{e.where("nsc","like",`%${t}%`).orWhereExists(s.default.query().whereColumn("users.id","Technicians.userId").where(e=>{e.where("firstName","ilike",`%${t}%`).orWhere("lastName","ilike",`%${t}%`)}))}),e?(0,a.simplePaginatedList)(r,e):r}async getTechnicianById(e){return i.default.query().findById(e).withGraphFetched("user")}};t.TechnicianService=c,t.TechnicianService=c=o([(0,n.Injectable)()],c)},6381:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.NSCEnum=void 0,function(e){e.None="None",e.CAC_PAT="CAC-PAT",e.CAC_PAU="CAC-PAU",e.CAC_PGI="CAC-PGI",e.CAC_PSV="CAC-PSV",e.PAT="PAT",e.PGI="PGI",e.PM="PM",e.PACMY="PACMY",e.PASSAP="PASSAP",e.PSV="PSV",e.PISCAP="PISCAP",e.PMIC="PMIC",e.Hussmann="Hussmann",e.PSP="PSP",e.PNZ="PNZ",e.PPH="PPH",e.PSTH="PSTH",e.PAMB="PAMB",e.PACB="PACB",e.PM_PACMY="PM/PACMY",e.PACVN="PACVN",e.GMC="GMC",e.PAPMAP="PAPMAP",e.PACPH="PACPH",e.PAU="PAU",e.PPNDTH="PPNDTH"}(r||(t.NSCEnum=r={}))},6496:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.MembershipTypeEnum=void 0,function(e){e.None="None",e.Standard="Standard",e.Silver="Silver",e.Gold="Gold",e.Platinum="Platinum",e.Diamond="Diamond"}(r||(t.MembershipTypeEnum=r={}))},6578:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.MasterDataModule=void 0;const n=r(1813),i=r(9227);let s=class{};t.MasterDataModule=s,t.MasterDataModule=s=o([(0,n.Module)({providers:[i.MasterDataService],exports:[i.MasterDataService]})],s)},6661:e=>{e.exports=require("@nestjs/jwt")},6881:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.PaginationDto=void 0,r(1321);const i=r(284),s=r(6325),a=r(7621),c=r(1916),l=r(581),d=r(1495),u=r(3020),p=r(2520);class f{constructor(){this.page=1,this.count=10}getOffset(){return(0,u.paginationExtractOffsetAndLimit)(this).offset}}t.PaginationDto=f,o([(0,s.IsInt)(),(0,s.IsPositive)(),(0,s.Min)(1),(0,i.Type)(()=>Number),(0,p.ApiProperty)({description:"Current page number begining from 1",required:!0,example:1,type:"number"}),n("design:type",Object)],f.prototype,"page",void 0),o([(0,s.IsInt)(),(0,s.IsPositive)(),(0,s.Min)(1),(0,s.Max)(100),(0,i.Type)(()=>Number),(0,p.ApiProperty)({description:"Item per-page count",required:!0,example:10,type:"number"}),n("design:type",Object)],f.prototype,"count",void 0),o([(0,s.IsOptional)(),(0,c.IsSingleKeyObjectWithEnum)(a.PaginationSortOrder,{each:!0}),(0,s.IsArray)(),(0,i.Transform)(l.sortsTransformer),(0,p.ApiProperty)({description:"Array of sorting items",required:!1,isArray:!0,type:"array"}),n("design:type",Array)],f.prototype,"sorts",void 0),o([(0,s.IsOptional)(),(0,c.IsOneOf)([d.PaginationFilterOrDto,d.PaginationFilterAndDto]),(0,s.ValidateNested)({each:!0}),(0,i.Transform)(l.filtersTransformer),(0,p.ApiProperty)({type:"array",description:"Filters object with Array or Object as OR and AND logic",required:!1,isArray:!0}),n("design:type",Object)],f.prototype,"filters",void 0)},6963:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.InvoiceService=void 0;const n=r(1813),i=r(5e3),s=r(4014);let a=class{async listInvoices(e,t,r){const o=i.default.query();return r&&o.where("workOrderId",r),t&&o.where("invoiceNumber","like",`%${t}%`).orWhere("status","like",`%${t}%`),e?(0,s.simplePaginatedList)(o,e):o}async getInvoiceById(e){const t=await i.default.query().findById(e);if(!t)throw new n.NotFoundException(`Invoice with ID ${e} not found`);return t}async createInvoice(e){return i.default.query().insert(e)}async updateInvoice(e,t){return(await this.getInvoiceById(e)).$query().patchAndFetch(t)}async deleteInvoice(e){if(0===await i.default.query().deleteById(e))throw new n.NotFoundException(`Invoice with ID ${e} not found`);return{success:!0,id:e}}};t.InvoiceService=a,t.InvoiceService=a=o([(0,n.Injectable)()],a)},7118:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.PartnerModule=void 0;const n=r(1813),i=r(823);let s=class{};t.PartnerModule=s,t.PartnerModule=s=o([(0,n.Module)({providers:[i.PartnerService],exports:[i.PartnerService]})],s)},7175:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AuthExpiredAccessTokenException=t.AuthForbiddenException=void 0;const o=r(1813),n=r(4671);class i extends o.ForbiddenException{constructor(e){let t="You don't have permission to ";Array.isArray(e)?t+=e.map(e=>(0,n.stringifyAccess)(e)).join(" OR "):t+=(0,n.stringifyAccess)(e),super(t),this.missingAccess=e}}t.AuthForbiddenException=i;class s extends Error{constructor(e="Access Token expired"){super(e)}}t.AuthExpiredAccessTokenException=s},7326:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CreateSampleDto=t.SampleDto=void 0;t.SampleDto=class{};t.CreateSampleDto=class{}},7359:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(7861),n=r(7729);class i extends o.Model{}i.tableName=n.constants.TableName.WorkOrderJobReason,i.idColumn="id",i.jsonSchema={type:"object",properties:{id:{type:"integer"},work_order_sub_status_id:{type:"integer"},slug:{type:"string"},name:{type:"string"},created_at:{type:"string"},created_by:{type:"integer"}}},t.default=i},7435:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.databaseProviders=t.KNEX_CONNECTION=void 0;const o=r(7861),n=r(6046),i=r(1514),s=r(1813);t.KNEX_CONNECTION="KNEX_CONNECTION",t.databaseProviders=[{provide:t.KNEX_CONNECTION,inject:[i.ConfigService],useFactory:async e=>{const t=new s.Logger("Database"),r=(0,n.default)({client:"pg",connection:e.get("DATABASE_URL"),pool:{min:1,max:parseInt(e.get("DATABASE_POOLS_MAX","10")),afterCreate:(e,r)=>{t.verbose(`Pool opened: ${e.__knexUid}`),e.once("error",r=>{t.error(`Database connection error (${e.__knexUid}): ${r.message||r}`)}),e.once("close",()=>{t.verbose(`Pool closed: ${e.__knexUid}`)}),r(null,e)}},acquireConnectionTimeout:3e4});o.Model.knex(r);try{await r.raw("SELECT 1")}catch(e){throw new Error(`Database Module Error: ${e.message||e}`)}return r}}]},7507:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(2087),t),n(r(8526),t)},7546:e=>{e.exports=require("@nestjs/common/utils/shared.utils")},7578:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},7598:e=>{e.exports=require("node:crypto")},7621:(e,t)=>{var r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.Pagination=t.FilterOperator=t.PaginationSortOrder=void 0,function(e){e.ASC="ASC",e.DESC="DESC"}(r||(t.PaginationSortOrder=r={})),function(e){e.equal="equal",e.notEqual="notEqual",e.like="like",e.between="between",e.lessThan="lessThan",e.greaterThan="greaterThan",e.isNull="isNull",e.isNotNull="isNotNull",e.in="in",e.notIn="notIn"}(o||(t.FilterOperator=o={}));t.Pagination=class{}},7637:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.WorkOrderCustomerTypeEnum=void 0,function(e){e.None="None",e.Customer="customer",e.Dealer="dealer",e.Subdealer="subdealer",e.ASCUser="ASC (user)",e.Internal="internal"}(r||(t.WorkOrderCustomerTypeEnum=r={}))},7652:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.ChargeModule=void 0;const n=r(1813),i=r(4773);let s=class{};t.ChargeModule=s,t.ChargeModule=s=o([(0,n.Module)({providers:[i.ChargeService],exports:[i.ChargeService]})],s)},7729:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.utils=t.constants=t.enums=void 0,n(r(8111),t),n(r(3487),t),n(r(1206),t),t.enums=r(6088),t.constants=r(8239),n(r(1944),t),n(r(9344),t),n(r(9586),t),n(r(7507),t),n(r(9846),t),n(r(287),t),n(r(606),t),n(r(2848),t),n(r(9493),t),n(r(6150),t),t.utils=r(2935),n(r(4014),t),n(r(266),t),n(r(8430),t),n(r(9044),t),n(r(5635),t),n(r(803),t),n(r(1212),t),n(r(2490),t),n(r(9837),t),n(r(5906),t)},7819:e=>{e.exports=require("@nestjs/core")},7861:e=>{e.exports=require("objection")},7976:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.splitName=function(e){if(!e)return{firstName:"",middleName:"",lastName:""};const t=e.trim().split(/\s+/);if(1===t.length)return{firstName:t[0],middleName:"",lastName:""};if(2===t.length)return{firstName:t[0],middleName:"",lastName:t[1]};if(3===t.length)return{firstName:t[0],middleName:t[1],lastName:t[2]};return{firstName:t[0],middleName:t[1],lastName:t.slice(2).join(" ")}}},8072:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.NatsModule=void 0;const n=r(1813),i=r(1514),s=r(345),a=r(5780);let c=class{};t.NatsModule=c,t.NatsModule=c=o([(0,n.Module)({imports:[i.ConfigModule],providers:[n.Logger,{provide:"NATS_SERVICE",useFactory:e=>{const t=e.get("NATS_URL");return a.ClientProxyFactory.create({transport:a.Transport.NATS,options:{servers:[t],jetstream:!0,connection:{debug:!1,reconnect:!0,maxReconnectAttempts:-1,waitOnFirstConnect:!0}}})},inject:[i.ConfigService]},s.NatsService],exports:[n.Logger,"NATS_SERVICE",s.NatsService]})],c)},8109:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},8111:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(2982),t),n(r(7435),t)},8239:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(1193),t)},8347:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(7861),n=r(9857),i=r(7729);class s extends o.Model{}s.tableName=i.constants.TableName.Users,s.idColumn="id",s.relationMappings={role:{modelClass:n.default,relation:o.Model.HasOneRelation,join:{from:`${i.constants.TableName.Users}.roleId`,to:`${i.constants.TableName.Roles}.id`}}},t.default=s},8352:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.RbacModule=void 0;const n=r(1813),i=r(5057);let s=class{};t.RbacModule=s,t.RbacModule=s=o([(0,n.Module)({providers:[i.RbacService],exports:[i.RbacService]})],s)},8430:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(4222),t),n(r(8491),t),n(r(3120),t)},8446:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},8491:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InterceptorResponse=void 0;t.InterceptorResponse=class{constructor(e,t,r){this.message=e,this.result=t,this.statusCode=r}getResponse(){const e=Object.create(null);return e.message=this.message,this.statusCode&&(e.statusCode=this.statusCode),this.result&&(e.result=this.result),e}}},8509:function(e,t,r){var o,n,i,s=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},c=this&&this.__param||function(e,t){return function(r,o){t(r,o,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.AuthenticationService=void 0;const l=r(1813),d=r(6661),u=r(9124),p=r(5306),f=r(4754);let y=class{constructor(e,t,r){this.jwtService=e,this.jwtModuleOptions=t,this.logger=r,r||(this.logger=new l.Logger("AuthService")),this.expiresIn=f(process.env.JWT_ACCESS_TOKEN_EXPIRES_IN||"30m"),this.rembemberMeExpiresIn=f(process.env.JWT_ACCESS_TOKEN_REMEMBER_EXPIRES_IN||"7 days")}generateToken(e,t,r){r=r||this.expiresIn,this.logger.log(`Generating acces token for ID ${e} expires in ${r}`);const o={userId:e,app:t};return this.jwtService.sign(o,{expiresIn:r})}decodeToken(e){return this.logger.verbose(`Decoding JWT token ${(e||"").slice(0,10)}*******`),this.jwtService.decode(e)}isThisRoleAllowedToLoginApp(e,t){if(!e)return!1;switch(t){case p.TokenApp.CUSTOMER:return"customer"==e;case p.TokenApp.TECHNICIAN:return e.startsWith("technis");case p.TokenApp.PARTNER:return"customer"!=e&&!e.startsWith("technis");default:return!1}}};t.AuthenticationService=y,t.AuthenticationService=y=s([(0,l.Injectable)(),c(1,(0,l.Inject)(u.JWT_MODULE_OPTIONS)),c(2,(0,l.Inject)(l.Logger)),c(2,(0,l.Optional)()),a("design:paramtypes",["function"==typeof(o=void 0!==d.JwtService&&d.JwtService)?o:Object,"function"==typeof(n=void 0!==d.JwtModuleOptions&&d.JwtModuleOptions)?n:Object,"function"==typeof(i=void 0!==l.LoggerService&&l.LoggerService)?i:Object])],y)},8526:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.OtpModule=void 0;const n=r(1813),i=r(2087);let s=class{};t.OtpModule=s,t.OtpModule=s=o([(0,n.Module)({providers:[i.OtpService],exports:[i.OtpService]})],s)},8536:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.GenderEnum=void 0,function(e){e.None="None",e.Male="Male",e.Female="Female"}(r||(t.GenderEnum=r={}))},8570:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.InvoiceModule=void 0;const n=r(1813),i=r(6963);let s=class{};t.InvoiceModule=s,t.InvoiceModule=s=o([(0,n.Module)({providers:[i.InvoiceService],exports:[i.InvoiceService]})],s)},8703:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.LocationTypeEnum=void 0,function(e){e.None="None",e.WarehouseIGP="Warehouse - IGP",e.WarehouseFOC="Warehouse - FOC",e.WarehouseDiscount="Warehouse - Discount",e.WarehouseCampaign="Warehouse - Campaign",e.WarehouseASCLocal="Warehouse - ASC Local Location"}(r||(t.LocationTypeEnum=r={}))},8709:(e,t)=>{var r,o,n;Object.defineProperty(t,"__esModule",{value:!0}),t.CHANNEL_DISPATCHER_TYPE=t.NATS_CHANNEL_ACTION=t.CHANNEL_SENDER_DISPATCHER=void 0,t.unwrapNatsPayload=function(e){if(!e)return e;if("object"==typeof e&&"data"in e&&null!=e.data){const t=e.data;return"object"==typeof t&&t&&"data"in t&&null!=t.data?t.data:t}return e},function(e){e.CHANNEL_SEND_EMAIL="CAKRAWALA-HUB-SEND-EMAIL",e.CHANNEL_SEND_WHATSAPP="CAKRAWALA-HUB-SEND-WHATSAPP"}(r||(t.CHANNEL_SENDER_DISPATCHER=r={})),function(e){e.ACTIVATION_USER="ACTIVATION_USER",e.RESET_PASSWORD="RESET_PASSWORD",e.SURVEY_OTP_WEB="SURVEY_OTP_WEB",e.EXPORT="EXPORT"}(o||(t.NATS_CHANNEL_ACTION=o={})),function(e){e.EMAIL="EMAIL",e.WHATSAPP="WHATSAPP"}(n||(t.CHANNEL_DISPATCHER_TYPE=n={}))},8749:e=>{e.exports=require("crypto")},8956:function(e,t,r){var o,n=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.AuthenticationModule=void 0;const s=r(1813),a=r(6661),c=r(4602),l=r(8509),d=r(9124),u=r(1357),p=r(911),f=r(7819),y=r(5285);let m=class{constructor(e){this.modulesContainer=e,this.logger=new s.Logger("AuthPermissionsScanner")}onApplicationBootstrap(){const e=new f.MetadataScanner;for(const[t,r]of this.modulesContainer){const o=r.metatype?.name??t?.toString();if(!o)continue;const n=r.controllers;if(!n||"object"!=typeof n||!n.size)continue;const i=o.replace(/Module$/,"").replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/\s+/g,"-").toLowerCase();for(const[t,r]of n){const t=e.getAllMethodNames(r.instance);for(const e of t){const t=Reflect.getMetadata(d.PERMISSION_METADATA,r.instance[e]);t&&(t.module||(t.module=i),this.logger.verbose(`${o}/${e}: ModuleSlug: ${t.module}, Action: ${t.action}`))}}}}};t.AuthenticationModule=m,t.AuthenticationModule=m=n([(0,s.Module)({imports:[c.PassportModule],providers:[l.AuthenticationService,a.JwtService,u.AccessTokenStrategy,p.AccessTokenGuard,y.JwtModuleOptionsProvider,{provide:s.Logger,useValue:new s.Logger("Authentication")},{provide:f.APP_GUARD,useExisting:p.AccessTokenGuard}],exports:[d.JWT_MODULE_OPTIONS,u.AccessTokenStrategy,l.AuthenticationService,p.AccessTokenGuard]}),i("design:paramtypes",["function"==typeof(o=void 0!==f.ModulesContainer&&f.ModulesContainer)?o:Object])],m)},9031:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.NSCMYEnum=void 0,function(e){e.PM="PM",e.PACMY="PACMY"}(r||(t.NSCMYEnum=r={}))},9044:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(9787),t),n(r(3219),t),n(r(1960),t)},9124:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MODULE_SLUG=t.PERMISSION_METADATA=t.AUTH_GUARD=t.JWT_MODULE_OPTIONS=void 0,t.JWT_MODULE_OPTIONS="JWT_MODULE_OPTIONS",t.AUTH_GUARD="AUTH_GUARD",t.PERMISSION_METADATA=Symbol("PERMISSION"),t.MODULE_SLUG=Symbol("MODULE_SLUG")},9144:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(193),t)},9200:e=>{e.exports=require("passport-jwt")},9227:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.MasterDataService=void 0;const n=r(1813),i=r(1714),s=r(7359),a=r(171),c=r(4014);let l=class{async listIrisCodes(e,t){const r=i.default.query().whereNull("deletedAt");return t&&r.where(e=>{e.where("symptomCode","like",`%${t}%`).orWhere("defectCode","like",`%${t}%`).orWhere("conditionCode","like",`%${t}%`)}),e?(0,c.simplePaginatedList)(r,e):r}async getIrisCodeById(e){return i.default.query().findById(e)}async listJobReasons(e,t){const r=s.default.query();return t&&r.where("name","like",`%${t}%`).orWhere("slug","like",`%${t}%`),e?(0,c.simplePaginatedList)(r,e):r}async listWorkOrderStatuses(){return a.default.query()}};t.MasterDataService=l,t.MasterDataService=l=o([(0,n.Injectable)()],l)},9344:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(2067),t),n(r(1284),t),n(r(2213),t)},9347:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},9493:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(3147),t),n(r(2386),t)},9586:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(8509),t),n(r(8956),t),n(r(4671),t),n(r(5487),t),n(r(9124),t),n(r(5285),t),n(r(911),t),n(r(1357),t)},9709:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(7861),n=r(7729);class i extends o.Model{}i.tableName=n.constants.TableName.Charges,i.idColumn="id",i.jsonSchema={type:"object",required:["id","workOrderId","name","amount","currency"],properties:{id:{type:"integer"},workOrderId:{type:"integer"},name:{type:"string"},amount:{type:"number"},currency:{type:"string"},createdAt:{type:"string"},createdBy:{type:"integer"}}},t.default=i},9722:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.WorkOrderJobTypeEnum=void 0,function(e){e.None="None",e.WalkIn="Walk-In",e.OnSite="On-Site",e.Transfer="Transfer"}(r||(t.WorkOrderJobTypeEnum=r={}))},9787:function(e,t,r){var o,n=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0}),t.ExceptionHandler=void 0;const s=r(1813),a=r(7819),c=r(3219);let l=class extends a.BaseExceptionFilter{constructor(e){super(e?.httpAdapter),this.logger=new s.Logger("GlobalException")}catch(e,t){let r;if(this.logTheError(e),e instanceof c.ValidationException){const r=e.getResponse();return e.errorFields&&Object.keys(e.errorFields).length>0&&(r.errorFields=e.errorFields),super.catch(e,t)}if(e instanceof c.ApiException)return super.catch(e,t);if(e instanceof s.HttpException){const t=e.getResponse(),o=e.getStatus();let n=[],i={};if("string"==typeof t)n=t;else if("error"in t)if(Array.isArray(t.message)){n=t.message;const e={};t.message.forEach(t=>{const r=t.match(/^([a-zA-Z.]+)\s(.+)$/);if(r){const t=r[1],o=r[2];e[t]||(e[t]=[]),e[t].push(o)}}),Object.keys(e).length>0&&(i=e)}else n=t.message;if(r=new c.ApiException(o,n,e.cause),Object.keys(i).length>0){r.getResponse().errorFields=i}}else e instanceof Error&&(r=new c.ApiException(s.HttpStatus.INTERNAL_SERVER_ERROR,e.message));return super.catch(r||e,t)}logTheError(e){e instanceof s.HttpException?this.logger.error(`statusCode: ${e.getStatus()}, message: ${JSON.stringify(e.getResponse())}`):this.logger.error(e)}};t.ExceptionHandler=l,t.ExceptionHandler=l=n([(0,s.Catch)(),i("design:paramtypes",["function"==typeof(o=void 0!==a.HttpAdapterHost&&a.HttpAdapterHost)?o:Object])],l)},9837:function(e,t,r){var o=this&&this.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){void 0===o&&(o=r),e[o]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(8570),t),n(r(6963),t),n(r(43),t)},9846:function(e,t,r){var o=this&&this.__decorate||function(e,t,r,o){var n,i=arguments.length,s=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(i<3?n(s):i>3?n(t,r,s):n(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.LibraryModule=void 0;const n=r(1813),i=r(287);let s=class{};t.LibraryModule=s,t.LibraryModule=s=o([(0,n.Global)(),(0,n.Module)({providers:[i.LibraryService],exports:[i.LibraryService],imports:[]})],s)},9856:e=>{e.exports=require("http")},9857:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(7861),n=r(7729);class i extends o.Model{}i.tableName=n.constants.TableName.Roles,i.idColumn="id",i.relationMappings={role:{modelClass:n.UserModel,relation:o.Model.HasManyRelation,join:{from:`${n.constants.TableName.Roles}.id`,to:`${n.constants.TableName.Users}.roleId`}}},i.jsonSchema={type:"object",properties:{id:{type:"integer"},slug:{type:"string"},name:{type:"string"},description:{type:"string"},isAdmin:{type:"boolean"},isArea:{type:"boolean"},permissions:{type:"array",items:{type:"integer"}},status:{type:"boolean"}}},t.default=i},9944:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NATS_SUBJECTS=t.NATS_STREAMS=void 0,t.NATS_STREAMS={SEND_WHATSAPP:"CAKRAWALA-HUB-SEND-WHATSAPP",SEND_EMAIL:"CAKRAWALA-HUB-SEND-EMAIL"},t.NATS_SUBJECTS={SEND_WHATSAPP:"CAKRAWALA-HUB-SEND-WHATSAPP",SEND_EMAIL:"CAKRAWALA-HUB-SEND-EMAIL"}}},t={};var r=function r(o){var n=t[o];if(void 0!==n)return n.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,r),i.exports}(7729);module.exports=r})();